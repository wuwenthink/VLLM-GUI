<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VLLM GUI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #667eea;
            --primary-dark: #5a67d8;
            --secondary: #764ba2;
            --accent: #f093fb;
            --success: #22c55e;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;

            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            --primary-gradient-vibrant: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
            --success-gradient: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            --danger-gradient: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            --info-gradient: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            --warning-gradient: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            --exit-gradient: linear-gradient(135deg, #9333ea 0%, #7c3aed 100%);

            --bg-dark: #1e1e1e;
            --text-light: #f3f4f6;
            --border-color: #374151;
            --card-bg: #1f2937;
            --hover-bg: #374151;

            --glass-bg: rgba(255, 255, 255, 0.2);
            --glass-border: rgba(255, 255, 255, 0.3);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);

            --glow-primary: 0 0 20px rgba(102, 126, 234, 0.5);
            --glow-success: 0 0 20px rgba(34, 197, 94, 0.5);
            --glow-warning: 0 0 20px rgba(245, 158, 11, 0.5);
        }

        body {
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 50%, #dfe6ed 100%);
            background-attachment: fixed;
            background-size: 200% 200%;
            color: #1a1a2e;
            min-height: 100vh;
            font-size: 16px;
            animation: gradientFlow 10s ease infinite;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: visible;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 24px;
            margin: 12px;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.2);
            transition: all 0.3s ease;
        }

        .app-container:hover {
            box-shadow: 0 30px 100px rgba(102, 126, 234, 0.25);
        }

        .top-bar {
            background: var(--primary-gradient-vibrant);
            padding: 12px 24px;
            display: flex;
            align-items: center;
            gap: 20px;
            border-bottom: 3px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4);
            position: relative;
        }

        .top-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: shimmer 3s infinite;
        }

        .app-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.8em;
            font-weight: 800;
            color: #fff;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .app-title i {
            font-size: 1.4em;
            animation: bounce 2s infinite, glow 3s ease-in-out infinite, floatParticles 4s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.5)); }
            50% { filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.9)); }
        }

        .scheme-selector {
            flex: 1;
            position: relative;
            overflow: visible;
            isolation: isolate;
        }

        .scheme-select-container {
            position: relative;
        }

        .scheme-select {
            width: 100%;
            padding: 14px 20px;
            background: rgba(255, 255, 255, 0.2);
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            color: #fff;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            position: relative;
        }

        .scheme-select::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .scheme-select:hover::before {
            opacity: 0.1;
        }

        .scheme-select:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2), 0 0 15px rgba(102, 126, 234, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .scheme-select:active {
            transform: translateY(0) scale(0.98);
        }

        .scheme-selector label {
            display: block;
            font-size: 1em;
            font-weight: 600;
            color: #fff;
            margin-bottom: 8px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .scheme-select-container {
            position: static;
        }

        .scheme-select-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .scheme-count-badge {
            background: rgba(255, 255, 255, 0.3);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 700;
            color: #fff;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .scheme-count-badge:not([data-count="0"]) {
            animation: pulseBadge 2s ease-in-out infinite;
        }

        @keyframes pulseBadge {
            0%, 100% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.4); }
            50% { box-shadow: 0 0 10px 5px rgba(102, 126, 234, 0.2); }
        }

        .scheme-select:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2), 0 0 15px rgba(102, 126, 234, 0.3);
        }

        .scheme-select:active {
            transform: translateY(0);
        }

        .scheme-select option {
            background: #667eea;
            color: #fff;
            font-weight: 600;
        }

        .scheme-list-popup {
            position: fixed;
            top: 100px;
            left: 50px;
            background: rgba(255, 255, 255, 0.98);
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 16px;
            max-height: 450px;
            overflow-y: auto;
            z-index: 99999;
            display: none;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3), 0 0 30px rgba(102, 126, 234, 0.15);
            backdrop-filter: blur(20px);
            min-width: 300px;
        }

        .scheme-list-popup.show {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .scheme-item {
            padding: 16px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-bottom: 1px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
        }

        .scheme-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--primary-gradient-vibrant);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .scheme-item:hover {
            background: rgba(102, 126, 234, 0.15);
            transform: translateX(8px);
            padding-left: 24px;
        }

        .scheme-item:hover::before {
            transform: scaleY(1);
        }

        .scheme-item.selected {
            background: rgba(102, 126, 234, 0.2);
            border-left: none;
        }

        .scheme-item.selected::before {
            transform: scaleY(1);
        }

        .scheme-item-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--primary-gradient-vibrant);
            color: #fff;
            font-size: 1.2em;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            flex-shrink: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .scheme-item:hover .scheme-item-icon {
            transform: scale(1.15) rotate(8deg);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .scheme-item-icon:active {
            transform: scale(0.95);
        }

        .scheme-item-info {
            flex: 1;
            min-width: 0;
        }

        .scheme-item-name {
            font-weight: 700;
            color: #1a1a2e;
            font-size: 1.05em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .scheme-item-name::after {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #22c55e;
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .scheme-item.selected .scheme-item-name::after {
            opacity: 1;
        }

        .scheme-item-desc {
            font-size: 0.85em;
            color: #64748b;
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .scheme-item-desc i {
            font-size: 0.75em;
            opacity: 0.7;
        }

        .scheme-item-actions {
            display: flex;
            gap: 8px;
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .scheme-item:hover .scheme-item-actions {
            opacity: 1;
            transform: translateX(0);
        }

        .scheme-action-btn {
            padding: 8px 12px;
            background: rgba(102, 126, 234, 0.15);
            border: none;
            border-radius: 8px;
            color: #667eea;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.95em;
            display: flex;
            align-items: center;
            gap: 6px;
            position: relative;
            overflow: hidden;
        }

        .scheme-action-btn::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, transparent 70%);
            transform: scale(0);
            opacity: 0;
            transition: transform 0.4s, opacity 0.4s;
        }

        .scheme-action-btn:active::after {
            transform: scale(2);
            opacity: 1;
            transition: 0s;
        }

        .scheme-action-btn span {
            font-size: 0.85em;
            font-weight: 600;
        }

        .scheme-action-btn:hover {
            background: rgba(102, 126, 234, 0.3);
            color: #764ba2;
            transform: scale(1.05);
        }

        .scheme-action-btn.delete:hover {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .scheme-action-btn.delete:hover::after {
            background: radial-gradient(circle, rgba(239, 68, 68, 0.3) 0%, transparent 70%);
        }

        .scheme-action-btn.delete:active {
            transform: scale(0.95);
        }

        /* Dialog Styles */
        .dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }

        .dialog-content {
            background: #fff;
            border-radius: 20px;
            max-width: 520px;
            width: 90%;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);
            animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .dialog-content.dialog-large {
            max-width: 800px;
        }

        .dialog-content.dialog-medium {
            max-width: 600px;
        }

        .dialog-header {
            padding: 24px 28px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
            border-bottom: 1px solid rgba(102, 126, 234, 0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dialog-header h3 {
            margin: 0;
            font-size: 1.35em;
            font-weight: 700;
            color: #1a1a2e;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .dialog-header h3 i {
            background: var(--primary-gradient-vibrant);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .dialog-close {
            background: rgba(239, 68, 68, 0.08);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.6em;
            color: #ef4444;
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }

        .dialog-close:hover {
            background: rgba(239, 68, 68, 0.15);
            transform: scale(1.1) rotate(90deg);
        }

        .dialog-body {
            padding: 28px;
            max-height: 60vh;
            overflow-y: auto;
        }

        .dialog-body::-webkit-scrollbar {
            width: 6px;
        }

        .dialog-body::-webkit-scrollbar-track {
            background: transparent;
        }

        .dialog-body::-webkit-scrollbar-thumb {
            background: rgba(102, 126, 234, 0.3);
            border-radius: 3px;
        }

        .dialog-footer {
            padding: 20px 28px;
            background: rgba(102, 126, 234, 0.05);
            border-top: 1px solid rgba(102, 126, 234, 0.15);
            display: flex;
            justify-content: flex-end;
            gap: 14px;
        }

        .dialog-tabs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 24px;
        }

        .dialog-tab {
            padding: 14px 20px;
            background: rgba(102, 126, 234, 0.08);
            border: 2px solid transparent;
            border-radius: 12px;
            font-weight: 600;
            color: #667eea;
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.95em;
        }

        .dialog-tab:hover {
            background: rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
        }

        .dialog-tab.active {
            background: var(--primary-gradient-vibrant);
            color: #fff;
            border-color: transparent;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .dialog-tab i {
            font-size: 1.1em;
        }

        .dialog-tab-content {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .dialog-tab-content.active {
            display: block;
        }

        /* Scheme Preview Card */
        .scheme-preview-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
            border: 1px solid rgba(102, 126, 234, 0.2);
            border-radius: 14px;
            padding: 16px 20px;
            margin-bottom: 24px;
        }

        .scheme-preview-title {
            font-size: 0.8em;
            font-weight: 700;
            color: #667eea;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .scheme-preview-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .scheme-preview-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .scheme-preview-item i {
            width: 32px;
            height: 32px;
            background: rgba(102, 126, 234, 0.15);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #667eea;
            font-size: 0.9em;
        }

        .scheme-preview-item span {
            font-size: 0.9em;
            color: #64748b;
        }

        .scheme-preview-item strong {
            color: #1a1a2e;
            font-weight: 600;
            display: block;
            font-size: 0.85em;
        }

        /* Enhanced Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
            font-weight: 600;
            color: #1a1a2e;
            margin-bottom: 10px;
        }

        .form-label i {
            color: #667eea;
            font-size: 0.85em;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 14px 18px;
            background: #f8fafc;
            border: 2px solid rgba(102, 126, 234, 0.15);
            border-radius: 12px;
            font-size: 0.95em;
            color: #1a1a2e;
            transition: all 0.25s ease;
            font-family: inherit;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: #667eea;
            background: #fff;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
        }

        .form-input::placeholder, .form-textarea::placeholder {
            color: #94a3b8;
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23667eea' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            padding-right: 45px;
        }

        .form-info {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 14px 18px;
            background: rgba(102, 126, 234, 0.08);
            border-radius: 12px;
            font-size: 0.9em;
            color: #64748b;
            margin-top: 16px;
        }

        .form-info i {
            color: #667eea;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .scheme-action-btn:active {
            transform: scale(0.95);
        }

        .env-type-toggle {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .env-btn {
            padding: 14px 24px;
            border: 3px solid rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 700;
            font-size: 1em;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
        }

        .env-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border-color: rgba(255, 255, 255, 0.6);
        }

        .env-btn:active {
            transform: translateY(-1px) scale(0.98);
        }

        .env-btn.active {
            background: var(--primary-gradient-vibrant);
            border-color: transparent;
            color: #fff;
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.5);
            transform: translateY(-3px);
        }

        .env-btn.active:hover {
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.7);
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            font-size: 0.9em;
            font-weight: 600;
            color: #fff;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .status-indicator:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.02);
        }

        .status-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #22c55e;
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
            position: relative;
        }

        .status-dot::after {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border: 2px solid currentColor;
            border-radius: 50%;
            opacity: 0;
            animation: pulse 2s ease-out infinite;
        }

        .status-dot { color: #22c55e; }
        .status-dot.running { color: #f59e0b; }
        .status-dot.error { color: #ef4444; }

        .status-dot.running::after {
            opacity: 1;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }

        .main-content {
            display: flex;
            gap: 15px;
            padding: 15px;
            min-height: 0;
            overflow: hidden;
            position: relative;
        }

        .main-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 20% 20%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(118, 75, 162, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(240, 147, 251, 0.05) 0%, transparent 50%);
            pointer-events: none;
            animation: floatParticles 10s ease-in-out infinite;
        }

        .left-panel {
            flex: 0 0 520px;
            min-width: 450px;
            max-width: 520px;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .left-panel:hover {
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.25);
            border-color: rgba(102, 126, 234, 0.5);
        }

        .panel-header {
            padding: 18px 24px;
            background: var(--primary-gradient-vibrant);
            border-bottom: 2px solid rgba(255, 255, 255, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: breathingGlow 4s ease-in-out infinite;
        }

        .panel-title {
            font-size: 1.2em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #fff;
        }

        .panel-tabs {
            display: flex;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8eb 100%);
            border-bottom: 2px solid rgba(102, 126, 234, 0.3);
        }

        .panel-tab {
            flex: 1;
            padding: 16px 12px;
            background: transparent;
            border: none;
            color: #667eea;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .panel-tab::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: var(--primary-gradient-vibrant);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }

        .panel-tab:hover::after {
            width: 80%;
        }

        .panel-tab:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-3px);
        }

        .panel-tab.active {
            color: #764ba2;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
        }

        .panel-tab.active::after {
            width: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .panel-tab:active {
            transform: translateY(-1px) scale(0.98);
        }

        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }

        .panel-content::-webkit-scrollbar {
            width: 10px;
        }

        .panel-content::-webkit-scrollbar-track {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 5px;
        }

        .panel-content::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #667eea, #764ba2);
            border-radius: 5px;
        }

        .tab-pane {
            display: none;
            animation: fadeInUp 0.3s ease-out;
        }

        .tab-pane.active {
            display: block;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .param-group {
            margin-bottom: 20px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
            border-radius: 16px;
            padding: 20px;
            border: 2px solid rgba(102, 126, 234, 0.15);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            animation: scaleIn 0.3s ease-out;
            animation-fill-mode: both;
            position: relative;
            overflow: hidden;
        }

        .param-group::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #667eea, #764ba2, #f093fb);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .param-group:hover::before {
            opacity: 1;
        }

        .param-group:hover {
            border-color: rgba(102, 126, 234, 0.4);
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        .param-group:active {
            transform: translateY(0) scale(0.99);
        }

        .param-group:nth-child(1) { animation-delay: 0.05s; }
        .param-group:nth-child(2) { animation-delay: 0.1s; }
        .param-group:nth-child(3) { animation-delay: 0.15s; }
        .param-group:nth-child(4) { animation-delay: 0.2s; }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .param-group-title {
            font-size: 1.1em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.2);
        }

        .param-row {
            display: flex;
            flex-direction: column;
            margin-bottom: 15px;
            gap: 6px;
            position: relative;
        }

        .validation-status {
            position: absolute;
            right: 0;
            top: 42px;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s ease;
        }

        .validation-status.valid {
            opacity: 1;
            transform: scale(1);
            background: #22c55e;
            color: #fff;
        }

        .validation-status.invalid {
            opacity: 1;
            transform: scale(1);
            background: #ef4444;
            color: #fff;
        }

        .param-label {
            font-size: 0.95em;
            font-weight: 600;
            color: #4a5568;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .param-english {
            font-size: 0.75em;
            color: #94a3b8;
            font-weight: 400;
            font-family: 'Consolas', 'Monaco', monospace;
            background: rgba(102, 126, 234, 0.1);
            padding: 2px 8px;
            border-radius: 4px;
        }

        .param-input {
            width: 100%;
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.7);
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 12px;
            color: #1a1a2e;
            font-size: 0.95em;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .param-input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2), 0 8px 25px rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
        }

        .param-input:hover {
            border-color: rgba(102, 126, 234, 0.4);
        }

        .param-input:active {
            transform: scale(0.99);
        }

        .param-checkbox {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 18px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            color: #4a5568;
            font-size: 0.95em;
            border: 2px solid transparent;
        }

        .param-checkbox:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.3);
            transform: translateX(5px);
        }

        .param-checkbox:active {
            transform: scale(0.98);
        }

        .param-checkbox input {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: #667eea;
            transition: all 0.3s ease;
        }

        .param-checkbox input:checked {
            transform: scale(1.15);
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        .param-hint {
            font-size: 0.8em;
            margin-top: 4px;
            padding: 4px 8px;
            border-radius: 4px;
            display: none;
        }

        .param-hint.valid {
            display: block;
            color: #22c55e;
            background: rgba(34, 197, 94, 0.1);
        }

        .param-hint.warning {
            display: block;
            color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }

        .param-hint.error {
            display: block;
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .right-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .right-panel:hover {
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.25);
            border-color: rgba(102, 126, 234, 0.5);
        }

        .right-split-container {
            display: flex;
            height: 100%;
            min-height: 0;
            gap: 15px;
            padding: 15px;
        }

        .command-section {
            width: 35%;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .command-preview-box {
            background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
            border-radius: 16px;
            padding: 18px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: scaleIn 0.4s ease-out;
            position: relative;
            overflow: auto;
            max-height: 300px;
        }

        .command-preview-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #22c55e, #16a34a, #22c55e);
            background-size: 200% 100%;
            animation: gradientFlow 3s linear infinite;
        }

        .section-title {
            font-size: 1em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #fff;
            margin-bottom: 12px;
        }

        .section-title i {
            color: #a78bfa;
        }

        .command-content {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 14px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85em;
            color: #22c55e;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 180px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .command-content {
            scrollbar-width: thin;
            scrollbar-color: rgba(102, 126, 234, 0.8) rgba(0, 0, 0, 0.3);
        }

        .command-content::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        .command-content::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 5px;
        }

        .command-content::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border-radius: 5px;
            cursor: pointer;
        }

        .command-content::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #8891e8 0%, #9b5fd9 50%, #f5a8fc 100%);
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        .command-content::-webkit-scrollbar-corner {
            background: rgba(0, 0, 0, 0.4);
        }

        .status-box {
            background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
            border-radius: 16px;
            padding: 18px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: scaleIn 0.4s ease-out;
            animation-delay: 0.1s;
            animation-fill-mode: both;
            position: relative;
            overflow: visible;
            flex-shrink: 0;
        }

        .status-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb, #667eea);
            background-size: 300% 100%;
            animation: gradientFlow 3s linear infinite;
        }

        .status-box.running::before {
            animation-duration: 1s;
        }

        .status-content {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 14px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            color: #e6edf3;
            min-height: 60px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .status-content .running-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .status-content .running-status .status-label {
            color: #f59e0b;
            font-weight: 600;
        }
        
        .status-content .running-status .port-badge {
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid rgba(245, 158, 11, 0.5);
            border-radius: 6px;
            padding: 4px 12px;
            color: #f59e0b;
            font-weight: 700;
            font-size: 0.9em;
        }

        .status-content.ready { color: #22c55e; }
        .status-content.running {
            color: #f59e0b;
            animation: pulse 1s ease-in-out infinite;
            box-shadow: inset 0 0 20px rgba(245, 158, 11, 0.2);
        }
        .status-content.stopping {
            color: #f97316;
            animation: pulse 0.5s ease-in-out infinite;
            box-shadow: inset 0 0 15px rgba(249, 115, 22, 0.3);
        }
        .status-content.error { color: #ef4444; background: rgba(239, 68, 68, 0.1); }

        .gpu-status-box {
            background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
            border-radius: 16px;
            padding: 18px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: scaleIn 0.4s ease-out;
            animation-delay: 0.15s;
            animation-fill-mode: both;
            position: relative;
            overflow-y: auto;
            max-height: 300px;
            margin-top: 15px;
        }
        
        .gpu-status-box::-webkit-scrollbar {
            width: 6px;
        }

        .gpu-status-box::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
        }

        .gpu-status-box::-webkit-scrollbar-thumb {
            background: rgba(102, 126, 234, 0.5);
            border-radius: 3px;
        }

        .gpu-status-box::-webkit-scrollbar-thumb:hover {
            background: rgba(102, 126, 234, 0.7);
        }

        .gpu-status-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #22c55e, #3b82f6, #22c55e);
            background-size: 200% 100%;
            animation: gradientFlow 3s linear infinite;
        }

        .gpu-status-box.running::before {
            animation-duration: 1s;
        }

        .gpu-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #e6edf3;
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 14px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(102, 126, 234, 0.2);
        }

        .gpu-title i {
            color: #22c55e;
            font-size: 1.2em;
            animation: pulse 2s ease-in-out infinite;
        }

        .gpu-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .gpu-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 16px;
            display: grid;
            grid-template-columns: 1.8fr 1.2fr 1fr 1fr 1fr;
            gap: 16px;
            align-items: center;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .gpu-item:hover {
            background: rgba(102, 126, 234, 0.15);
        }

        .gpu-name {
            color: #e6edf3;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1em;
        }

        .gpu-name i {
            color: #3b82f6;
        }

        .gpu-memory {
            color: #22c55e;
            text-align: center;
        }

        .gpu-util {
            color: #f59e0b;
            text-align: center;
        }

        .gpu-temp {
            color: #ef4444;
            text-align: center;
        }

        .gpu-power {
            color: #a855f7;
            text-align: center;
        }

        .gpu-fan {
            color: #22c55e;
            text-align: center;
        }
        
        /* GPU Progress Bars */
        .gpu-progress-container {
            display: flex;
            flex-direction: column;
            gap: 6px;
            min-width: 100px;
        }
        
        .gpu-progress-item {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .gpu-progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .gpu-progress-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .gpu-progress-fill.memory {
            background: linear-gradient(90deg, #22c55e, #16a34a);
        }
        
        .gpu-progress-fill.util {
            background: linear-gradient(90deg, #f59e0b, #d97706);
        }
        
        .gpu-progress-label {
            font-size: 0.85em;
            color: #8b949e;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .gpu-label {
            color: #8b949e;
            font-size: 0.9em;
            display: block;
            margin-bottom: 2px;
        }

        .gpu-empty {
            color: #8b949e;
            text-align: center;
            padding: 20px;
            font-style: italic;
        }

        .action-buttons {
            display: flex;
            flex-direction: row;
            gap: 8px;
            animation: scaleIn 0.4s ease-out;
            animation-delay: 0.2s;
            animation-fill-mode: both;
        }

        .action-buttons button {
            padding: 5px 8px;
            border: none;
            border-radius: 8px;
            font-size: 0.75em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            position: relative;
            overflow: hidden;
        }

        .action-buttons button::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            transform: scale(0);
            opacity: 0;
            transition: transform 0.4s, opacity 0.4s;
        }

        .action-buttons button:active::after {
            transform: scale(2);
            opacity: 1;
            transition: 0s;
        }

        .action-buttons button:hover:not(:disabled) {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .action-buttons button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-generate {
            background: var(--primary-gradient-vibrant);
            color: #fff;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
        }

        .btn-generate:hover {
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.6);
        }

        .btn-run {
            background: var(--success-gradient);
            color: #fff;
            box-shadow: 0 2px 8px rgba(34, 197, 94, 0.4);
        }

        .btn-run:hover {
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.6);
        }

        .btn-stop {
            background: var(--danger-gradient);
            color: #fff;
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.4);
        }

        .btn-stop:hover {
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.6);
        }

        .btn-save {
            background: var(--info-gradient);
            color: #fff;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.4);
        }

        .btn-save:hover {
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.6);
        }

        .btn-exit {
            background: var(--exit-gradient);
            color: #fff;
            box-shadow: 0 2px 8px rgba(147, 51, 234, 0.4);
        }

        .btn-exit:hover {
            box-shadow: 0 4px 15px rgba(147, 51, 234, 0.6);
        }

        /* Dialog Button Styles */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .btn::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            transform: scale(0);
            opacity: 0;
            transition: transform 0.4s, opacity 0.4s;
        }

        .btn:active::after {
            transform: scale(2);
            opacity: 1;
            transition: 0s;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-primary {
            background: var(--primary-gradient-vibrant);
            color: #fff;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:hover {
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.6);
        }

        .btn-secondary {
            background: rgba(102, 126, 234, 0.15);
            color: #667eea;
            border: 2px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(102, 126, 234, 0.25);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4);
        }

        .terminal-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: linear-gradient(135deg, #0d1117 0%, #161b22 50%, #1a1f26 100%);
            border-radius: 16px;
            overflow: hidden;
            border: 2px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .terminal-main {
            display: flex;
            flex-direction: column;
            height: 100%;
            min-height: 0;
        }
        
        .terminal-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
            background-size: 200% 100%;
            animation: gradientFlow 3s linear infinite;
        }

        .terminal-section.running::before {
            animation: gradientFlow 1.5s linear infinite;
        }

        .terminal-header {
            padding: 14px 20px;
            background: var(--primary-gradient-vibrant);
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .terminal-title {
            font-size: 1.1em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #fff;
        }

        .terminal-title i {
            animation: pulse 2s infinite, glow 3s ease-in-out infinite;
        }

        .clear-btn {
            padding: 8px 14px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .clear-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.2);
        }

        .clear-btn:active {
            transform: translateY(0) scale(0.95);
        }

        .terminal-content {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            overflow-x: auto;
            font-family: 'Consolas', 'Courier New', 'Microsoft YaHei', monospace;
            font-size: 0.9em;
            line-height: 1.6;
            position: relative;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: break-all;
        }

        .terminal-content.running {
            background: linear-gradient(180deg, transparent 0%, rgba(102, 126, 234, 0.05) 50%, transparent 100%);
            animation: pulse 3s ease-in-out infinite;
        }

        .terminal-content.running::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, #667eea, #764ba2, transparent);
            animation: scanLine 2s linear infinite;
        }
        
        /* Terminal Input Area */
        .terminal-input-area {
            display: flex;
            gap: 10px;
            padding: 12px 15px;
            background: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(102, 126, 234, 0.2);
        }
        
        .terminal-input-area input {
            flex: 1;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            color: #e6edf3;
            font-size: 0.9em;
            font-family: 'Consolas', 'Monaco', monospace;
            transition: all 0.3s ease;
        }
        
        .terminal-input-area input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
        }
        
        .terminal-input-area input::placeholder {
            color: #8b949e;
        }
        
        .terminal-input-area .run-cmd-btn {
            padding: 12px 20px;
            background: var(--success-gradient);
            border: none;
            border-radius: 10px;
            color: #fff;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .terminal-input-area .run-cmd-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(34, 197, 94, 0.4);
        }
        
        .terminal-input-area .run-cmd-btn:active {
            transform: translateY(0) scale(0.98);
        }

        .terminal-content::-webkit-scrollbar {
            width: 10px;
        }

        .terminal-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 5px;
        }

        .terminal-content::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #667eea, #764ba2);
            border-radius: 5px;
        }

        .terminal-line {
            margin-bottom: 2px;
            padding: 2px 4px;
            white-space: pre-wrap;
            word-break: break-all;
            transition: all 0.2s ease;
            animation: fadeInUp 0.2s ease-out;
            border-radius: 4px;
        }

        .terminal-line:hover {
            background: rgba(255, 255, 255, 0.08);
            padding-left: 8px;
        }

        .terminal-line.new-line {
            animation: fadeInUp 0.3s ease-out, shimmer 2s infinite;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            background-size: 200% 100%;
        }

        .terminal-line.prompt { color: #4caf50; font-weight: bold; }
        .terminal-line.input { color: #87ceeb; }
        .terminal-line.output { color: #ffffff; }
        .terminal-line.error { color: #ff4444; font-weight: bold; background: rgba(255, 0, 0, 0.15); }
        .terminal-line.warning { color: #ffbb33; background: rgba(255, 187, 51, 0.1); }
        .terminal-line.info { color: #42a5f5; }
        .terminal-line.system { color: #ce93d8; font-weight: bold; }
        .terminal-line.success { color: #66bb6a; font-weight: bold; }

        .custom-params-section {
            margin-top: 10px;
        }

        .custom-param-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            padding: 10px;
            background: rgba(102, 126, 234, 0.08);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .custom-param-row:hover {
            background: rgba(102, 126, 234, 0.15);
            transform: translateX(5px);
        }

        .custom-param-row:active {
            transform: scale(0.99);
        }

        .custom-param-row input[type="text"] {
            flex: 1;
            min-width: 0;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.7);
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 8px;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }

        .custom-param-row input[type="text"]:first-of-type {
            flex: 2;
            min-width: 180px;
        }

        .custom-param-row input[type="text"]:nth-of-type(2) {
            flex: 1;
            min-width: 100px;
        }

        .custom-param-row input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
            transform: scale(1.02);
        }

        .custom-param-row .flag-checkbox {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85em;
            color: #4a5568;
            white-space: nowrap;
        }

        .quick-param-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .quick-param-row input {
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.7);
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 8px;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .quick-param-row input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
        }

        .quick-param-row input::placeholder {
            color: #94a3b8;
            font-size: 0.85em;
        }

        .custom-param-row .flag-checkbox input {
            flex: 0;
            width: 18px;
            height: 18px;
        }

        .remove-param-btn {
            background: rgba(239, 68, 68, 0.15);
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            color: #ef4444;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .remove-param-btn::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, transparent 70%);
            transform: scale(0);
            opacity: 0;
            transition: transform 0.4s, opacity 0.4s;
        }

        .remove-param-btn:active::after {
            transform: scale(2);
            opacity: 1;
            transition: 0s;
        }

        .remove-param-btn:hover {
            background: rgba(239, 68, 68, 0.3);
            transform: scale(1.05);
        }

        .remove-param-btn:active {
            transform: scale(0.95);
        }

        .add-param-btn {
            width: 100%;
            padding: 12px;
            background: rgba(102, 126, 234, 0.15);
            border: 2px dashed rgba(102, 126, 234, 0.4);
            border-radius: 10px;
            color: #667eea;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 8px;
        }

        .add-param-btn:hover {
            background: rgba(102, 126, 234, 0.25);
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.2);
        }

        .add-param-btn:active {
            transform: translateY(0) scale(0.98);
        }

        .reference-category {
            margin-bottom: 20px;
        }

        .reference-category-title {
            font-size: 1em;
            font-weight: 700;
            color: #764ba2;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.2);
        }

        .reference-item {
            display: flex;
            margin-bottom: 8px;
            padding: 10px 12px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .reference-item:hover {
            background: rgba(102, 126, 234, 0.15);
            transform: translateX(8px);
            padding-left: 16px;
        }

        .reference-item:active {
            transform: translateX(4px) scale(0.99);
        }

        .reference-param {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85em;
            color: #667eea;
            min-width: 180px;
        }

        .reference-desc {
            font-size: 0.85em;
            color: #4a5568;
        }

        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .toast {
            padding: 16px 24px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.95) 100%);
            border-radius: 14px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            min-width: 280px;
            font-size: 1em;
            font-weight: 600;
            animation: toastIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 4px solid;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .toast::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
        }

        .toast.success::before { background: #22c55e; }
        .toast.error::before { background: #ef4444; }
        .toast.warning::before { background: #f59e0b; }
        .toast.info::before { background: #3b82f6; }

        @keyframes toastIn {
            from { opacity: 0; transform: translateX(50px) scale(0.9); }
            to { opacity: 1; transform: translateX(0) scale(1); }
        }

        @keyframes toastOut {
            from { opacity: 1; transform: translateX(0) scale(1); }
            to { opacity: 0; transform: translateX(50px) scale(0.9); }
        }

        @keyframes toastOutUp {
            from { opacity: 1; transform: translateY(0) scale(1); }
            to { opacity: 0; transform: translateY(-20px) scale(0.9); }
        }

        .toast.success { border-left-color: #22c55e; background: linear-gradient(135deg, rgba(34, 197, 94, 0.95) 0%, rgba(22, 163, 74, 0.95) 100%); }
        .toast.error { border-left-color: #ef4444; background: linear-gradient(135deg, rgba(239, 68, 68, 0.95) 0%, rgba(220, 38, 38, 0.95) 100%); }
        .toast.warning { border-left-color: #f59e0b; background: linear-gradient(135deg, rgba(245, 158, 11, 0.95) 0%, rgba(217, 119, 6, 0.95) 100%); }
        .toast.info { border-left-color: #3b82f6; background: linear-gradient(135deg, rgba(59, 130, 246, 0.95) 0%, rgba(37, 99, 235, 0.95) 100%); }

        .toast.removing {
            animation: toastOutUp 0.3s ease-in forwards;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite, glow 2s ease-in-out infinite;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ========================================
           ENHANCED UI/UX IMPROVEMENTS
           ======================================== */

        /* -----------------------------
           Enhanced Scrollbar Styles
           ----------------------------- */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: linear-gradient(180deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
            border-radius: 6px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #667eea, #764ba2);
            border-radius: 6px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
            transition: all 0.2s ease;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #764ba2, #8b5cf6);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.5);
            transform: scaleX(1.1);
        }

        ::-webkit-scrollbar-thumb:active {
            background: linear-gradient(180deg, #5a67d8, #6b21a8);
        }

        ::-webkit-scrollbar-corner {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 0 0 6px 0;
        }

        /* -----------------------------
           Enhanced Focus States
           ----------------------------- */
        *:focus-visible {
            outline: 3px solid rgba(102, 126, 234, 0.6);
            outline-offset: 2px;
        }

        *:focus:not(:focus-visible) {
            outline: none;
        }

        .param-input:focus-visible,
        .param-checkbox input:focus-visible,
        .scheme-select:focus-visible {
            outline: 3px solid rgba(102, 126, 234, 0.8);
            outline-offset: 3px;
            box-shadow: 0 0 0 6px rgba(102, 126, 234, 0.2);
        }

        /* -----------------------------
           Enhanced Button Interactions
           ----------------------------- */
        .btn-generate,
        .btn-run,
        .btn-stop,
        .btn-save,
        .btn-exit {
            position: relative;
            overflow: hidden;
            letter-spacing: 0.5px;
        }

        .btn-generate::after,
        .btn-run::after,
        .btn-stop::after,
        .btn-save::after,
        .btn-exit::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.4s, height 0.4s, opacity 0.4s;
            opacity: 0;
        }

        .btn-generate:active::after,
        .btn-run:active::after,
        .btn-stop:active::after,
        .btn-save:active::after,
        .btn-exit:active::after {
            width: 300px;
            height: 300px;
            opacity: 0;
            transition: 0s;
        }

        .btn-generate:hover,
        .btn-run:hover,
        .btn-stop:hover,
        .btn-save:hover,
        .btn-exit:hover {
            transform: translateY(-4px) scale(1.02);
            letter-spacing: 1px;
        }

        .btn-generate:active,
        .btn-run:active,
        .btn-stop:active,
        .btn-save:active,
        .btn-exit:active {
            transform: translateY(-1px) scale(0.98);
        }

        /* Button disabled state enhancement */
        .action-buttons button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        .action-buttons button:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        /* -----------------------------
           Form Field Enhancements
           ----------------------------- */
        .param-input {
            position: relative;
        }

        .param-input::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
            border-radius: 12px 12px 0 0;
        }

        .param-input:focus::before {
            opacity: 1;
        }

        .param-input:hover:not(:focus) {
            border-color: rgba(102, 126, 234, 0.5);
            background: rgba(255, 255, 255, 0.85);
        }

        .param-input::placeholder {
            color: #94a3b8;
            font-style: italic;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .param-input:focus::placeholder {
            opacity: 0.4;
        }

        /* Input validation states */
        .param-input.valid {
            border-color: #22c55e;
            background: rgba(34, 197, 94, 0.05);
        }

        .param-input.invalid {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.05);
            animation: shake 0.4s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }

        /* -----------------------------
           Enhanced Card/Panel Designs
           ----------------------------- */
        .param-group {
            position: relative;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.06) 0%, rgba(118, 75, 162, 0.06) 100%);
            overflow: hidden;
        }

        .param-group::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .param-group:hover::after {
            opacity: 1;
        }

        .param-group:hover {
            border-color: rgba(102, 126, 234, 0.5);
            box-shadow: 0 15px 50px rgba(102, 126, 234, 0.2);
        }

        /* -----------------------------
           Typography Hierarchy
           ----------------------------- */
        .param-label {
            font-size: 0.9em;
            font-weight: 600;
            color: #4a5568;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: color 0.2s ease;
        }

        .param-label:hover {
            color: #667eea;
        }

        .param-label i {
            font-size: 0.85em;
            opacity: 0.7;
            transition: opacity 0.2s ease, transform 0.2s ease;
        }

        .param-label:hover i {
            opacity: 1;
            transform: scale(1.1);
        }

        /* -----------------------------
           Tooltip Enhancements
           ----------------------------- */
        [data-tooltip] {
            position: relative;
        }

        [data-tooltip]::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: calc(100% + 10px);
            left: 50%;
            transform: translateX(-50%) translateY(5px);
            padding: 8px 14px;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            color: #fff;
            font-size: 0.8em;
            font-weight: 500;
            white-space: nowrap;
            border-radius: 8px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            pointer-events: none;
        }

        [data-tooltip]::after {
            content: '';
            position: absolute;
            bottom: calc(100% + 2px);
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: #0f172a;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
        }

        [data-tooltip]:hover::before,
        [data-tooltip]:hover::after {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(0);
        }

        /* -----------------------------
           Enhanced Checkbox & Radio
           ----------------------------- */
        .param-checkbox input[type="checkbox"] {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 2px solid rgba(102, 126, 234, 0.4);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .param-checkbox input[type="checkbox"]:checked {
            background: var(--primary-gradient-vibrant);
            border-color: transparent;
            transform: scale(1.1);
        }

        .param-checkbox input[type="checkbox"]:checked::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 14px;
            font-weight: bold;
        }

        .param-checkbox input[type="checkbox"]:hover {
            border-color: #667eea;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.3);
        }

        .param-checkbox input[type="checkbox"]:focus {
            outline: none;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.3);
        }

        /* -----------------------------
           Selection Style
           ----------------------------- */
        ::selection {
            background: rgba(102, 126, 234, 0.3);
            color: #fff;
        }

        .command-content::selection {
            background: rgba(102, 126, 234, 0.5);
            color: #fff;
        }

        /* -----------------------------
           Loading State Enhancements
           ----------------------------- */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            backdrop-filter: blur(5px);
        }

        .loading-spinner {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        .loading-spinner .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(102, 126, 234, 0.2);
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loading-spinner span {
            color: #667eea;
            font-weight: 600;
        }

            /* -----------------------------
               Status Indicator Improvements
               ----------------------------- */
            .status-indicator {
                display: flex;
                align-items: center;
                gap: 10px;
                padding: 8px 16px;
                background: rgba(255, 255, 255, 0.2);
                border-radius: 30px;
                font-size: 0.9em;
                font-weight: 600;
                color: #fff;
                backdrop-filter: blur(10px);
                border: 2px solid rgba(255, 255, 255, 0.3);
                transition: all 0.3s ease;
            }

        .status-indicator.running {
            background: rgba(245, 158, 11, 0.3);
            border-color: rgba(245, 158, 11, 0.5);
            animation: statusPulse 2s ease-in-out infinite;
        }

        .status-indicator.error {
            background: rgba(239, 68, 68, 0.3);
            border-color: rgba(239, 68, 68, 0.5);
        }

        @keyframes statusPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 20px 10px rgba(245, 158, 11, 0.2); }
        }

        /* -----------------------------
           Terminal Line Improvements
           ----------------------------- */
        .terminal-line {
            margin-bottom: 2px;
            padding: 4px 8px;
            white-space: pre-wrap;
            word-break: break-all;
            transition: all 0.2s ease;
            animation: fadeInUp 0.2s ease-out;
            border-radius: 4px;
            font-family: 'JetBrains Mono', 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        .terminal-line:hover {
            background: rgba(255, 255, 255, 0.08);
            padding-left: 12px;
        }

        .terminal-line.prompt {
            color: #4caf50;
            font-weight: bold;
            background: rgba(76, 175, 80, 0.1);
        }

        .terminal-line.input {
            color: #87ceeb;
            background: rgba(135, 206, 235, 0.1);
        }

        .terminal-line.output {
            color: #e6edf3;
            background: transparent;
        }

        .terminal-line.error {
            color: #ff6b6b;
            font-weight: bold;
            background: rgba(255, 107, 107, 0.15);
        }

        .terminal-line.warning {
            color: #ffd93d;
            background: rgba(255, 217, 61, 0.1);
        }

        .terminal-line.info {
            color: #42a5f5;
            background: rgba(66, 165, 245, 0.1);
        }

        .terminal-line.system {
            color: #ce93d8;
            font-weight: bold;
            background: rgba(206, 147, 216, 0.1);
        }

        .terminal-line.success {
            color: #66bb6a;
            font-weight: bold;
            background: rgba(102, 187, 106, 0.1);
        }

        /* -----------------------------
           GPU Status Card Enhancement
           ----------------------------- */
        .gpu-item {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            padding: 16px;
            display: grid;
            grid-template-columns: 1.5fr 1fr 1fr 1fr 1fr;
            gap: 16px;
            align-items: center;
            font-family: 'JetBrains Mono', 'Consolas', monospace;
            font-size: 0.85em;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .gpu-item:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: rgba(102, 126, 234, 0.3);
            transform: translateX(5px);
        }

        .gpu-name {
            color: #e6edf3;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .gpu-name i {
            color: #3b82f6;
            font-size: 1.1em;
        }

        .gpu-memory {
            color: #22c55e;
            text-align: center;
            font-weight: 500;
        }

        .gpu-util {
            color: #f59e0b;
            text-align: center;
            font-weight: 500;
        }

        .gpu-temp {
            color: #ef4444;
            text-align: center;
            font-weight: 500;
        }

        .gpu-power {
            color: #a855f7;
            text-align: center;
            font-weight: 500;
        }

        .gpu-fan {
            color: #22c55e;
            text-align: center;
            font-weight: 500;
        }

        .gpu-label {
            color: #8b949e;
            font-size: 0.7em;
            display: block;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* -----------------------------
           Environment Toggle Enhancement
           ----------------------------- */
        .env-btn {
            padding: 14px 28px;
            border: 3px solid rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 700;
            font-size: 1em;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .env-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .env-btn:hover::before {
            left: 100%;
        }

        .env-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
            border-color: rgba(255, 255, 255, 0.6);
        }

        .env-btn.active {
            background: var(--primary-gradient-vibrant);
            border-color: transparent;
            color: #fff;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.6);
            transform: translateY(-4px);
        }

        .env-btn.active:hover {
            box-shadow: 0 15px 50px rgba(102, 126, 234, 0.8);
        }

        .env-btn i {
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }

        .env-btn:hover i {
            transform: scale(1.15);
        }

        .env-btn.active i {
            animation: iconPulse 1s ease-in-out infinite;
        }

        @keyframes iconPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* -----------------------------
           Scheme Item Enhancement
           ----------------------------- */
        .scheme-item {
            padding: 18px 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-bottom: 1px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
        }

        .scheme-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--primary-gradient-vibrant);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .scheme-item:hover {
            background: rgba(102, 126, 234, 0.1);
            padding-left: 28px;
        }

        .scheme-item:hover::before {
            transform: scaleY(1);
        }

        .scheme-item.selected {
            background: rgba(102, 126, 234, 0.15);
        }

        .scheme-item.selected::before {
            transform: scaleY(1);
        }

        .scheme-item-icon {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--primary-gradient-vibrant);
            color: #fff;
            font-size: 1.3em;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
            flex-shrink: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .scheme-item:hover .scheme-item-icon {
            transform: scale(1.15) rotate(8deg) translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.6);
        }

        .scheme-item-name {
            font-weight: 700;
            color: #1a1a2e;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .scheme-item-desc {
            font-size: 0.85em;
            color: #64748b;
            margin-top: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .scheme-item-actions {
            display: flex;
            gap: 10px;
            opacity: 0;
            transform: translateX(-15px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .scheme-item:hover .scheme-item-actions {
            opacity: 1;
            transform: translateX(0);
        }

        /* -----------------------------
           Quick Param Input Enhancement
           ----------------------------- */
        .quick-param-row input {
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 10px;
            font-size: 0.9em;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .quick-param-row input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2), 0 8px 25px rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
        }

        .quick-param-row input:hover:not(:focus) {
            border-color: rgba(102, 126, 234, 0.4);
        }

        /* -----------------------------
           Panel Header Enhancement
           ----------------------------- */
        .panel-header {
            padding: 20px 28px;
            background: var(--primary-gradient-vibrant);
            border-bottom: 3px solid rgba(255, 255, 255, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .panel-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, #fff, transparent);
            opacity: 0.3;
        }

        .panel-title {
            font-size: 1.3em;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #fff;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        /* -----------------------------
           Tab Enhancement
           ----------------------------- */
        .panel-tab {
            flex: 1;
            padding: 18px 16px;
            background: transparent;
            border: none;
            color: #667eea;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .panel-tab::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 4px;
            background: var(--primary-gradient-vibrant);
            transition: all 0.3s ease;
            transform: translateX(-50%);
            border-radius: 4px 4px 0 0;
        }

        .panel-tab:hover::after {
            width: 70%;
        }

        .panel-tab:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-3px);
        }

        .panel-tab.active {
            color: #764ba2;
            background: linear-gradient(180deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.1) 100%);
        }

        .panel-tab.active::after {
            width: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 4px;
        }

        .panel-tab i {
            margin-right: 8px;
            opacity: 0.8;
            transition: opacity 0.2s ease;
        }

        .panel-tab:hover i,
        .panel-tab.active i {
            opacity: 1;
        }

        /* -----------------------------
           Command Preview Enhancement
           ----------------------------- */
        .command-content {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 12px;
            padding: 16px;
            font-family: 'JetBrains Mono', 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            color: #22c55e;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .command-content::before {
            content: '$';
            color: #22c55e;
            font-weight: bold;
            margin-right: 8px;
        }

        .command-content::-webkit-scrollbar {
            width: 8px;
        }

        .command-content::-webkit-scrollbar-track {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 4px;
        }

        .command-content::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #667eea, #764ba2);
            border-radius: 4px;
        }

        .command-content::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #764ba2, #667eea);
        }

        /* -----------------------------
           Toast Notification Improvements
           ----------------------------- */
        .toast {
            padding: 18px 28px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.95) 100%);
            border-radius: 16px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 14px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.4);
            min-width: 320px;
            font-size: 1em;
            font-weight: 600;
            animation: toastIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 5px solid;
            backdrop-filter: blur(10px);
        }

        .toast.success {
            border-left-color: #22c55e;
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.95) 0%, rgba(22, 163, 74, 0.95) 100%);
        }

        .toast.error {
            border-left-color: #ef4444;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.95) 0%, rgba(220, 38, 38, 0.95) 100%);
        }

        .toast.warning {
            border-left-color: #f59e0b;
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.95) 0%, rgba(217, 119, 6, 0.95) 100%);
        }

        .toast.info {
            border-left-color: #3b82f6;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.95) 0%, rgba(37, 99, 235, 0.95) 100%);
        }

        .toast i {
            font-size: 1.3em;
        }

        .toast.success i { color: #86efac; }
        .toast.error i { color: #fca5a5; }
        .toast.warning i { color: #fcd34d; }
        .toast.info i { color: #93c5fd; }

        /* -----------------------------
           Gradient Text Effect
           ----------------------------- */
        .gradient-text {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
        }

        .gradient-text-inverse {
            background: linear-gradient(135deg, #1a1a2e 0%, #0d1117 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
        }

        /* -----------------------------
           Animation Classes
           ----------------------------- */
        .animate-in {
            animation: animateIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes animateIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .animate-out {
            animation: animateOut 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes animateOut {
            from {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
        }

        /* -----------------------------
           Enhanced Card Hover Effects
           ----------------------------- */
        .left-panel,
        .right-panel,
        .command-section,
        .terminal-section {
            will-change: transform, box-shadow;
        }

        .left-panel:hover,
        .right-panel:hover {
            box-shadow: 0 25px 80px rgba(102, 126, 234, 0.3);
            border-color: rgba(102, 126, 234, 0.6);
        }

        /* -----------------------------
           Disabled State Styling
           ----------------------------- */
        .param-input:disabled,
        .param-checkbox input:disabled {
            background: rgba(0, 0, 0, 0.05);
            border-color: rgba(102, 126, 234, 0.1);
            color: #94a3b8;
            cursor: not-allowed;
        }

        .param-checkbox input:disabled:checked {
            background: rgba(102, 126, 234, 0.3);
        }

        /* -----------------------------
           Empty State Styling
           ----------------------------- */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            text-align: center;
            color: #64748b;
        }

        .empty-state i {
            font-size: 3em;
            color: #94a3b8;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state span {
            font-size: 1em;
            font-weight: 500;
        }

        /* -----------------------------
           Terminal Header Enhancement
           ----------------------------- */
        .terminal-header {
            padding: 16px 24px;
            background: var(--primary-gradient-vibrant);
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .terminal-title {
            font-size: 1.15em;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #fff;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .terminal-title i {
            animation: pulse 2s infinite, glow 3s ease-in-out infinite;
        }

        .clear-btn {
            padding: 10px 18px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: #fff;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .clear-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.2);
        }

        .clear-btn:active {
            transform: translateY(0) scale(0.95);
        }

        /* -----------------------------
           Reference Item Enhancement
           ----------------------------- */
        .reference-item {
            display: flex;
            margin-bottom: 10px;
            padding: 14px 16px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid transparent;
        }

        .reference-item:hover {
            background: rgba(102, 126, 234, 0.15);
            border-color: rgba(102, 126, 234, 0.3);
            transform: translateX(10px);
            padding-left: 20px;
        }

        .reference-item:active {
            transform: translateX(5px) scale(0.99);
        }

        .reference-param {
            font-family: 'JetBrains Mono', 'Consolas', monospace;
            font-size: 0.9em;
            color: #667eea;
            min-width: 200px;
            font-weight: 600;
        }

        .reference-desc {
            font-size: 0.9em;
            color: #4a5568;
        }

        /* -----------------------------
           Add Button Enhancement
           ----------------------------- */
        .add-param-btn {
            width: 100%;
            padding: 14px;
            background: rgba(102, 126, 234, 0.12);
            border: 2px dashed rgba(102, 126, 234, 0.5);
            border-radius: 12px;
            color: #667eea;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .add-param-btn:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.25);
        }

        .add-param-btn:active {
            transform: translateY(0) scale(0.98);
        }

        .add-param-btn i {
            transition: transform 0.3s ease;
        }

        .add-param-btn:hover i {
            transform: rotate(90deg);
        }

        /* -----------------------------
           GPU Empty State
           ----------------------------- */
        .gpu-empty {
            color: #8b949e;
            text-align: center;
            padding: 30px;
            font-style: italic;
            font-size: 1em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .gpu-empty i {
            font-size: 1.3em;
            opacity: 0.6;
        }

        /* -----------------------------
           Scheme Select Enhancement
           ----------------------------- */
        .scheme-select {
            width: 100%;
            padding: 16px 24px;
            background: rgba(255, 255, 255, 0.2);
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 14px;
            color: #fff;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 14px;
            position: relative;
            appearance: none;
        }

        .scheme-select:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-3px) translateX(5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2), 0 0 20px rgba(102, 126, 234, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .scheme-select:active {
            transform: translateY(0) scale(0.98);
        }

        .scheme-select option {
            background: #667eea;
            color: #fff;
            font-weight: 600;
            padding: 10px;
        }

        /* -----------------------------
           Status Box Enhancement
           ----------------------------- */
            .status-box {
            background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
            border-radius: 18px;
            padding: 20px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 12px 50px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: visible;
            flex-shrink: 0;
        }

        .status-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb, #667eea);
            background-size: 300% 100%;
            animation: gradientFlow 3s linear infinite;
        }

        .status-content {
            background: rgba(0, 0, 0, 0.45);
            border-radius: 12px;
            padding: 16px;
            font-family: 'JetBrains Mono', 'Consolas', monospace;
            font-size: 1.1em;
            color: #e6edf3;
            min-height: 70px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }

        .status-content.ready { color: #22c55e; }
        .status-content.running {
            color: #f59e0b;
            animation: pulse 1s ease-in-out infinite;
            box-shadow: inset 0 0 20px rgba(245, 158, 11, 0.2);
            background: rgba(245, 158, 11, 0.05);
        }
        .status-content.error { color: #ef4444; background: rgba(239, 68, 68, 0.1); }

        /* -----------------------------
           GPU Status Box Enhancement
           ----------------------------- */
        .gpu-status-box {
            background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
            border-radius: 18px;
            padding: 20px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 12px 50px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow-y: auto;
            max-height: 350px;
            margin-top: 18px;
        }

        .gpu-status-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #22c55e, #3b82f6, #22c55e);
            background-size: 200% 100%;
            animation: gradientFlow 3s linear infinite;
        }

        .gpu-title {
            display: flex;
            align-items: center;
            gap: 12px;
            color: #e6edf3;
            font-size: 1.1em;
            font-weight: 700;
            margin-bottom: 16px;
            padding-bottom: 14px;
            border-bottom: 1px solid rgba(102, 126, 234, 0.2);
        }

        .gpu-title i {
            color: #22c55e;
            font-size: 1.3em;
            animation: pulse 2s ease-in-out infinite;
        }

        /* -----------------------------
           Command Preview Box Enhancement
           ----------------------------- */
        .command-preview-box {
            background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
            border-radius: 18px;
            padding: 20px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 12px 50px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: auto;
            max-height: 400px;
        }

        .command-preview-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #22c55e, #16a34a, #22c55e);
            background-size: 200% 100%;
            animation: gradientFlow 3s linear infinite;
        }

        /* -----------------------------
           App Container Enhancement
           ----------------------------- */
        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: visible;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 28px;
            margin: 12px;
            box-shadow: 0 30px 100px rgba(0, 0, 0, 0.25);
            border: 1px solid rgba(102, 126, 234, 0.2);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .app-container:hover {
            box-shadow: 0 35px 120px rgba(102, 126, 234, 0.3);
            border-color: rgba(102, 126, 234, 0.4);
        }

        /* -----------------------------
           Scheme Count Badge Enhancement
           ----------------------------- */
        .scheme-count-badge {
            background: rgba(255, 255, 255, 0.35);
            padding: 6px 14px;
            border-radius: 25px;
            font-size: 0.85em;
            font-weight: 700;
            color: #fff;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .scheme-count-badge:not([data-count="0"]) {
            animation: pulseBadge 2s ease-in-out infinite;
        }

        .scheme-count-badge:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: scale(1.1);
        }

        /* -----------------------------
           Action Button Enhancement
           ----------------------------- */
        .action-buttons button {
            padding: 14px 20px;
            border: none;
            border-radius: 12px;
            font-size: 1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
            letter-spacing: 0.5px;
        }

        .action-buttons button:hover:not(:disabled) {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.35);
        }

        .action-buttons button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none;
        }

        /* -----------------------------
           Reference Category Enhancement
           ----------------------------- */
        .reference-category {
            margin-bottom: 24px;
        }

        .reference-category-title {
            font-size: 1.1em;
            font-weight: 700;
            color: #764ba2;
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.2);
        }

        .reference-category-title i {
            color: #667eea;
        }

        /* -----------------------------
           Remove Button Enhancement
           ----------------------------- */
        .remove-param-btn {
            background: rgba(239, 68, 68, 0.15);
            border: none;
            border-radius: 10px;
            padding: 10px 14px;
            color: #ef4444;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .remove-param-btn:hover {
            background: rgba(239, 68, 68, 0.35);
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.3);
        }

        .remove-param-btn:active {
            transform: scale(0.95);
        }

        /* -----------------------------
           Custom Param Row Enhancement
           ----------------------------- */
        .custom-param-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding: 12px;
            background: rgba(102, 126, 234, 0.08);
            border-radius: 12px;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .custom-param-row:hover {
            background: rgba(102, 126, 234, 0.15);
            transform: translateX(8px);
            border-color: rgba(102, 126, 234, 0.3);
        }

        .custom-param-row input[type="text"] {
            flex: 1;
            min-width: 0;
            padding: 10px 14px;
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 10px;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .custom-param-row input[type="text"]:first-of-type {
            flex: 2;
            min-width: 200px;
        }

        .custom-param-row input[type="text"]:nth-of-type(2) {
            flex: 1;
            min-width: 120px;
        }

        .custom-param-row input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
            transform: scale(1.02);
        }

        .custom-param-row input[type="text"]:hover:not(:focus) {
            border-color: rgba(102, 126, 234, 0.4);
        }

        /* -----------------------------
           Scheme Action Button Enhancement
           ----------------------------- */
        .scheme-action-btn {
            padding: 10px 14px;
            background: rgba(102, 126, 234, 0.15);
            border: none;
            border-radius: 10px;
            color: #667eea;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.95em;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .scheme-action-btn:hover {
            background: rgba(102, 126, 234, 0.3);
            color: #764ba2;
            transform: scale(1.1);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .scheme-action-btn.delete:hover {
            background: rgba(239, 68, 68, 0.25);
            color: #ef4444;
        }

        .scheme-action-btn:active {
            transform: scale(0.95);
        }

        .scheme-action-btn span {
            font-size: 0.9em;
            font-weight: 600;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        @keyframes ripple {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(4); opacity: 0; }
        }

        @keyframes floatParticles {
            0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.3; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 0.7; }
        }

        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes breathingGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(102, 126, 234, 0.3); }
            50% { box-shadow: 0 0 30px rgba(102, 126, 234, 0.6), 0 0 50px rgba(102, 126, 234, 0.3); }
        }

        @keyframes typingCursor {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        @keyframes rotatingBorder {
            0% { border-color: #667eea; }
            33% { border-color: #764ba2; }
            66% { border-color: #f093fb; }
            100% { border-color: #667eea; }
        }

        @keyframes scanLine {
            0% { top: 0; opacity: 0.5; }
            50% { opacity: 1; }
            100% { top: 100%; opacity: 0.5; }
        }

        @keyframes orbit {
            0% { transform: rotate(0deg) translateX(50px) rotate(0deg); }
            100% { transform: rotate(360deg) translateX(50px) rotate(-360deg); }
        }

        @keyframes neonFlicker {
            0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% { opacity: 1; }
            20%, 24%, 55% { opacity: 0.5; }
        }

        .btn-ripple {
            position: relative;
            overflow: hidden;
        }

        .btn-ripple::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, transparent 70%);
            transform: scale(0);
            opacity: 0;
            transition: transform 0.5s, opacity 0.5s;
        }

        .btn-ripple:active::after {
            transform: scale(2);
            opacity: 1;
            transition: 0s;
        }

        .btn-click:active {
            transform: scale(0.95) !important;
        }

        @keyframes successFlash {
            0% { background-color: rgba(34, 197, 94, 0.3); }
            100% { background-color: transparent; }
        }

        .success-flash {
            animation: successFlash 0.5s ease-out;
        }

        .magnetic:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
        }

        @keyframes glitch {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-2px); }
            40% { transform: translateX(2px); }
            60% { transform: translateX(-1px); }
            80% { transform: translateX(1px); }
        }

        .glitch-active {
            animation: glitch 0.3s ease-in-out;
        }

        .rainbow-border {
            position: relative;
            border: 3px solid transparent;
            background: linear-gradient(#fff, #fff) padding-box,
                        linear-gradient(90deg, #667eea, #764ba2, #f093fb) border-box;
            background-size: 100% 100%, 300% 300%;
            animation: gradientFlow 3s ease infinite;
        }

        .breathing-glow {
            animation: breathingGlow 3s ease-in-out infinite;
        }

        .typing-cursor::after {
            content: '|';
            animation: typingCursor 1s infinite;
        }

        .rotating-border {
            animation: rotatingBorder 4s linear infinite;
        }

        .scan-line {
            position: relative;
            overflow: hidden;
        }

        .scan-line::before {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.5), transparent);
            animation: scanLine 3s linear infinite;
            z-index: 10;
        }

        .orbiting-dot {
            position: absolute;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, #667eea, #764ba2);
            border-radius: 50%;
            animation: orbit 4s linear infinite;
        }

        .neon-flicker {
            animation: neonFlicker 4s infinite;
        }

        .floating-particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.6), transparent);
            border-radius: 50%;
            animation: floatParticles 6s ease-in-out infinite;
            pointer-events: none;
        }

        .bg-animation {
            position: relative;
            overflow: hidden;
        }

        .bg-animation::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
            animation: floatParticles 15s ease-in-out infinite;
        }

        .interactive-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .interactive-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        .interactive-card:active {
            transform: translateY(-2px) scale(0.98);
        }

        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.3);
        }

        .hover-scale {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .hover-scale:hover {
            transform: scale(1.05);
        }

        .click-feedback {
            position: relative;
        }

        .click-feedback::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(102, 126, 234, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s, opacity 0.3s;
            opacity: 0;
        }

        .click-feedback:active::before {
            width: 200%;
            height: 200%;
            opacity: 1;
            transition: 0s;
        }

        .shimmer-effect {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }

        .gradient-text {
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
            background-size: 200% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientFlow 3s ease infinite;
        }

        .pulse-ring {
            position: relative;
        }

        .pulse-ring::after {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border: 2px solid var(--primary);
            border-radius: inherit;
            animation: pulse 2s ease-out infinite;
            opacity: 0;
        }

        .pulse-ring.running::after {
            opacity: 1;
        }

        .status-pulse {
            animation: pulse 2s infinite;
        }

        .glow-pulse {
            animation: breathingGlow 2s ease-in-out infinite;
        }

        @keyframes borderGlow {
            0%, 100% { border-color: rgba(102, 126, 234, 0.5); }
            50% { border-color: rgba(118, 75, 162, 0.8); }
        }

        .border-glow {
            animation: borderGlow 3s ease-in-out infinite;
        }

        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
            }

            .left-panel {
                width: 100%;
                height: 45%;
            }

            .right-panel {
                height: 55%;
            }

            .right-split-container {
                flex-direction: column;
            }

            .command-section {
                width: 100%;
                flex-direction: row;
            }

            .command-preview-box, .status-box, .action-buttons {
                flex: 1;
            }

            .action-buttons {
                flex-direction: row;
                flex-wrap: wrap;
            }

            .action-buttons button {
                flex: 1;
                min-width: 100px;
            }
        }

        @media (max-width: 768px) {
            .top-bar {
                flex-wrap: wrap;
                gap: 15px;
            }

            .app-title {
                font-size: 1.5em;
            }

            .command-section {
                flex-direction: column;
            }

            .action-buttons {
                flex-direction: column;
            }

            .action-buttons button {
                width: 100%;
            }
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .scheme-count-badge:empty,
        .scheme-count-badge[data-count="0"] {
            display: none;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(102, 126, 234, 0.5); }
            50% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.8); }
        }

        .log-line {
            animation: fadeInUp 0.2s ease-out;
        }
    </style>
    <!-- Minimal Right Panel Fixes -->
    <link rel="stylesheet" href="vllm_right_panel_minimal_fix.css">
</head>
<body>
    <div class="app-container">
        <div class="top-bar">
            <div class="app-title">
                <i class="fas fa-brain"></i>
                <span>VLLM GUI</span>
            </div>
            <div class="scheme-selector">
                <label></label>
                <div class="scheme-select-container">
                    <div class="scheme-select" id="currentScheme" onclick="toggleSchemeList()">
                        <div class="scheme-select-left">
                            <i class="fas fa-list"></i>
                            <span id="schemeSelectText">...</span>
                        </div>
                        <span class="scheme-count-badge" id="schemeCountBadge" data-count="0">0</span>
                    </div>
                </div>
            </div>
            <div class="env-type-toggle">
                <button class="env-btn active" data-env="wsl" onclick="selectEnv('wsl')">
                    <i class="fab fa-linux"></i> WSL
                </button>
                <button class="env-btn" data-env="linux" onclick="selectEnv('linux')">
                    <i class="fas fa-server"></i> Linux
                </button>
            </div>
            <div class="status-indicator" id="statusIndicator">
                <div class="status-dot" id="statusDot"></div>
                <span id="statusText"></span>
            </div>
        </div>

        <div class="main-content">
            <div class="left-panel">
                <div class="panel-tabs">
                    <button class="panel-tab active" data-tab="main" onclick="switchTab(this, 'main')">
                        <i class="fas fa-list"></i> 
                    </button>
                    <button class="panel-tab" data-tab="custom" onclick="switchTab(this, 'custom')">
                        <i class="fas fa-sliders-h"></i> 
                    </button>
                    <button class="panel-tab" data-tab="reference" onclick="switchTab(this, 'reference')">
                        <i class="fas fa-book"></i> 
                    </button>
                </div>
                <div class="panel-content">
                    <div id="tab-main" class="tab-pane active">
                        <div class="param-group">
                            <div class="param-group-title">
                                <i class="fas fa-microchip"></i> WSL/
                            </div>
                            <div class="param-row" id="wslPathRow">
                                <label class="param-label">
                                    WSL
                                    <span class="param-english">wslPath</span>
                                </label>
                                <input type="text" class="param-input" id="wslPath" placeholder="wsl  C:\Windows\System32\wsl.exe">
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    Conda
                                    <span class="param-english">condaEnv</span>
                                </label>
                                <input type="text" class="param-input" id="condaEnv" placeholder="vllm" oninput="validateInput(this, 'condaEnvHint')">
                                <div class="param-hint" id="condaEnvHint"></div>
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    Conda
                                    <span class="param-english">condaPath</span>
                                </label>
                                <input type="text" class="param-input" id="condaPath" placeholder="..." readonly style="background-color: #f5f5f5; color: #666;">
                            </div>
                        </div>

                        <div class="param-group">
                            <div class="param-group-title">
                                <i class="fas fa-tachometer-alt"></i> GPU
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    CUDA
                                    <span class="param-english">cudaDevices</span>
                                </label>
                                <input type="text" class="param-input" id="cudaDevices" placeholder="0  0,1,2,3" oninput="validateInput(this, 'cudaDevicesHint')">
                                <div class="param-hint" id="cudaDevicesHint"></div>
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">tensorParallel</span>
                                </label>
                                <input type="number" class="param-input" id="tensorParallel" value="1" min="1">
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">pipelineParallelSize</span>
                                </label>
                                <input type="number" class="param-input" id="pipelineParallelSize" value="1" min="1">
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">enableExpertParallel</span>
                                </label>
                                <input type="checkbox" class="param-checkbox" id="enableExpertParallel">
                            </div>
                        </div>

                        <!-- Quick Custom Params - GPU Area -->
                        <div class="param-group" style="margin-top: 15px; border: 2px dashed rgba(102, 126, 234, 0.3); padding: 15px; border-radius: 12px;">
                            <div class="param-group-title" style="color: #667eea;">
                                <i class="fas fa-sliders-h"></i> 
                            </div>
                            <p style="font-size: 0.85em; color: #64748b; margin-bottom: 12px;">
                                vllm serveexport: CUDA_DEVICE_ORDER=PCI_BUS_ID
                            </p>
                            <div id="gpuQuickParamsContainer">
                                <div class="quick-param-row">
                                    <input type="text" placeholder=" (: --enforce-eager)" class="param-input quick-param-name" style="flex: 1;">
                                    <input type="text" placeholder=" ()" class="param-input quick-param-value" style="flex: 1;">
                                </div>
                                <div class="quick-param-row">
                                    <input type="text" placeholder="" class="param-input quick-param-name" style="flex: 1;">
                                    <input type="text" placeholder="" class="param-input quick-param-value" style="flex: 1;">
                                </div>
                                <div class="quick-param-row">
                                    <input type="text" placeholder="" class="param-input quick-param-name" style="flex: 1;">
                                    <input type="text" placeholder="" class="param-input quick-param-value" style="flex: 1;">
                                </div>
                                <div class="quick-param-row">
                                    <input type="text" placeholder="" class="param-input quick-param-name" style="flex: 1;">
                                    <input type="text" placeholder="" class="param-input quick-param-value" style="flex: 1;">
                                </div>
                                <div class="quick-param-row">
                                    <input type="text" placeholder="" class="param-input quick-param-name" style="flex: 1;">
                                    <input type="text" placeholder="" class="param-input quick-param-value" style="flex: 1;">
                                </div>
                                <div class="quick-param-row">
                                    <input type="text" placeholder="" class="param-input quick-param-name" style="flex: 1;">
                                    <input type="text" placeholder="" class="param-input quick-param-value" style="flex: 1;">
                                </div>
                                <div class="quick-param-row">
                                    <input type="text" placeholder="" class="param-input quick-param-name" style="flex: 1;">
                                    <input type="text" placeholder="" class="param-input quick-param-value" style="flex: 1;">
                                </div>
                                <div class="quick-param-row">
                                    <input type="text" placeholder="" class="param-input quick-param-name" style="flex: 1;">
                                    <input type="text" placeholder="" class="param-input quick-param-value" style="flex: 1;">
                                </div>
                                <div class="quick-param-row">
                                    <input type="text" placeholder="" class="param-input quick-param-name" style="flex: 1;">
                                    <input type="text" placeholder="" class="param-input quick-param-value" style="flex: 1;">
                                </div>
                                <div class="quick-param-row">
                                    <input type="text" placeholder="" class="param-input quick-param-name" style="flex: 1;">
                                    <input type="text" placeholder="" class="param-input quick-param-value" style="flex: 1;">
                                </div>
                            </div>
                        </div>

                        <div class="param-group">
                            <div class="param-group-title">
                                <i class="fas fa-box"></i> 
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">modelPath</span>
                                </label>
                                <input type="text" class="param-input" id="modelPath" placeholder="/mnt/d/models/Llama-2-7b-chat-hf  ~/models/llama" oninput="validateInput(this, 'modelPathHint')">
                                <div class="param-hint" id="modelPathHint"></div>
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">quantization</span>
                                </label>
                                <input type="text" class="param-input" id="quantization" placeholder="awq, gptq, squeezellm ">
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">dtype</span>
                                </label>
                                <input type="text" class="param-input" id="dtype" placeholder="auto, half, float, bfloat16, float8_e4m3fn, float8_e5m2">
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">maxModelLen</span>
                                </label>
                                <input type="number" class="param-input" id="maxModelLen" placeholder="">
                            </div>
                        </div>

                        <div class="param-group">
                            <div class="param-group-title">
                                <i class="fas fa-bolt"></i> 
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    host
                                    <span class="param-english">host</span>
                                </label>
                                <input type="text" class="param-input" id="host" placeholder="0.0.0.0">
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">port</span>
                                </label>
                                <input type="number" class="param-input" id="port" value="8000" min="1" max="65535" oninput="validateInput(this, 'portHint')">
                                <div class="param-hint" id="portHint"></div>
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    GPU
                                    <span class="param-english">gpuMemoryUtilization</span>
                                </label>
                                <input type="number" class="param-input" id="gpuMemoryUtilization" value="0.9" min="0" max="1" step="0.1">
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">maxNumSequences</span>
                                </label>
                                <input type="number" class="param-input" id="maxNumSequences" value="256" min="1">
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">maxNumBatchedTokens</span>
                                </label>
                                <input type="number" class="param-input" id="maxNumBatchedTokens" value="8192" min="1">
                            </div>
                        </div>

                        <div class="param-group">
                            <div class="param-group-title">
                                <i class="fas fa-plus-circle"></i> 
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">servedModelName</span>
                                </label>
                                <input type="text" class="param-input" id="servedModelName" placeholder="">
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">chatTemplate</span>
                                </label>
                                <input type="text" class="param-input" id="chatTemplate" placeholder="">
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">toolCallParser</span>
                                </label>
                                <input type="text" class="param-input" id="toolCallParser" placeholder="">
                            </div>
                            <div class="param-row">
                                <label class="param-label">
                                    
                                    <span class="param-english">reasoningParser</span>
                                </label>
                                <input type="text" class="param-input" id="reasoningParser" placeholder="">
                            </div>
                        </div>

                        <div class="param-group" style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.08) 0%, rgba(16, 185, 129, 0.08) 100%); border-color: rgba(34, 197, 94, 0.2);">
                            <div class="param-group-title" style="color: #22c55e;">
                                <i class="fas fa-shield-alt"></i> 
                            </div>
                            <label class="param-checkbox">
                                <input type="checkbox" id="trustRemoteCode">
                                <span> <span class="param-english">trustRemoteCode</span></span>
                            </label>

                            <label class="param-checkbox" style="margin-top: 10px;">
                                <input type="checkbox" id="enableAutoToolChoice">
                                <span> <span class="param-english">enableAutoToolChoice</span></span>
                            </label>
                            <label class="param-checkbox" style="margin-top: 10px;">
                                <input type="checkbox" id="asyncScheduling">
                                <span> <span class="param-english">asyncScheduling</span></span>
                            </label>
                        </div>
                    </div>

                    <div id="tab-custom" class="tab-pane">
                        <div class="param-group">
                            <div class="param-group-title">
                                <i class="fas fa-sliders-h"></i> 
                            </div>
                            <p style="font-size: 0.9em; color: #64748b; margin-bottom: 15px;">
                                CLIvLLM
                            </p>
                            <div id="customParamsContainer">
                                <div class="custom-param-row">
                                    <input type="text" placeholder=" (: --max-num-batched-tokens)" class="param-name">
                                    <input type="text" placeholder="" class="param-value">
                                    <label class="flag-checkbox">
                                        <input type="checkbox"> 
                                    </label>
                                    <button class="remove-param-btn" onclick="removeCustomParam(this)">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                            <button class="add-param-btn" onclick="addCustomParam()">
                                <i class="fas fa-plus"></i> 
                            </button>
                        </div>
                    </div>

                    <div id="tab-reference" class="tab-pane">
                        <div class="reference-category">
                            <div class="reference-category-title">
                                <i class="fas fa-server"></i> 
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--host</span>
                                <span class="reference-desc">IP</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--port</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--uvicorn-log-level</span>
                                <span class="reference-desc">Uvicorn</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--allow-credentials</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--allowed-origins</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--allowed-methods</span>
                                <span class="reference-desc">HTTP (GET, POST)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--allowed-headers</span>
                                <span class="reference-desc">HTTP</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--api-key</span>
                                <span class="reference-desc">API ()</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--root-path</span>
                                <span class="reference-desc">FastAPI</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--max-model-len</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--tokenizer-pool</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--disable-frontend-multiprocessing</span>
                                <span class="reference-desc">OpenAI</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--enable-request-id-headers</span>
                                <span class="reference-desc">X-Request-Id</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--enable-auto-tool-choice</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--tool-call-parser</span>
                                <span class="reference-desc"></span>
                            </div>
                        </div>

                        <div class="reference-category">
                            <div class="reference-category-title">
                                <i class="fas fa-tachometer-alt"></i> 
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--gpu-memory-utilization</span>
                                <span class="reference-desc">GPU (0.9)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--max-num-batched-tokens</span>
                                <span class="reference-desc">token (2k)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--max-num-seqs</span>
                                <span class="reference-desc"> (256)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--quantization</span>
                                <span class="reference-desc"> (awq, gptq, squeezellm, fp8, mxfp4, bitsandbytes)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--dtype</span>
                                <span class="reference-desc"> (auto, half, float, bfloat16)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--trust-remote-code</span>
                                <span class="reference-desc"> (false)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--download-dir</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--load-format</span>
                                <span class="reference-desc"> (auto, pt, safetensors, gguf, etc.)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--enable-chunked-prefill</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--enable-prefix-caching</span>
                                <span class="reference-desc"> (false)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--enforce-eager</span>
                                <span class="reference-desc">eager (CUDA)</span>
                            </div>
                        </div>

                        <div class="reference-category">
                            <div class="reference-category-title">
                                <i class="fas fa-project-diagram"></i> 
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--tensor-parallel-size</span>
                                <span class="reference-desc"> (1)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--pipeline-parallel-size</span>
                                <span class="reference-desc"> (1)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--distributed-executor-backend</span>
                                <span class="reference-desc"> (mp, ray)</span>
                            </div>
                        </div>

                        <div class="reference-category">
                            <div class="reference-category-title">
                                <i class="fas fa-layer-group"></i> LoRA
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--enable-lora</span>
                                <span class="reference-desc">LoRA</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--lora-modules</span>
                                <span class="reference-desc">LoRA (=JSON)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--lora-dtype</span>
                                <span class="reference-desc">LoRA (auto, float16, bfloat16)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--long-lora-scaling-factors</span>
                                <span class="reference-desc">Long LoRA</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--lora-request-types</span>
                                <span class="reference-desc">LoRA</span>
                            </div>
                        </div>

                        <div class="reference-category">
                            <div class="reference-category-title">
                                <i class="fas fa-layer-group"></i> LoRA
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--enable-lora</span>
                                <span class="reference-desc">LoRA</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--lora-modules</span>
                                <span class="reference-desc">LoRA</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--lora-dtype</span>
                                <span class="reference-desc">LoRA</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--long-lora-scaling-factors</span>
                                <span class="reference-desc">Long LoRA</span>
                            </div>
                        </div>

                        <div class="reference-category">
                            <div class="reference-category-title">
                                <i class="fas fa-eye"></i> VLM
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-input-type</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-token-id</span>
                                <span class="reference-desc">token ID</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-input-shape</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-feature-size</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-processor</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-processor-trust-remote-code</span>
                                <span class="reference-desc"></span>
                            </div>
                        </div>

                        <div class="reference-category">
                            <div class="reference-category-title">
                                <i class="fas fa-magic"></i> 
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--guided-choice</span>
                                <span class="reference-desc"> ()</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--guided-json</span>
                                <span class="reference-desc">JSON (JSONJSON)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--guided-regex</span>
                                <span class="reference-desc"> ()</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--guided-grammar</span>
                                <span class="reference-desc"> ()</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--structured-outputs</span>
                                <span class="reference-desc"> (JSONjson/regex/grammar/choice)</span>
                            </div>
                        </div>


                            <div class="reference-item">
                                <span class="reference-param">--logging-level</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--log-requests</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--traced-callbacks</span>
                                <span class="reference-desc"></span>
                        </div>

                        <div class="reference-category">
                            <div class="reference-category-title">
                                <i class="fas fa-eye"></i> VLM
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-input-type</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-token-id</span>
                                <span class="reference-desc">token ID</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-input-shape</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-feature-size</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-processor</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--image-processor-trust-remote-code</span>
                                <span class="reference-desc"></span>
                            </div>
                        </div>

                        <div class="reference-category">
                            <div class="reference-category-title">
                                <i class="fas fa-bug"></i> 
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--headless</span>
                                <span class="reference-desc"> ()</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--api-server-count</span>
                                <span class="reference-desc">API (1)</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--disable-log-stats</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--aggregate-engine-logging</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--enable-log-requests</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--tokenizer-revision</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--skip-tokenizer-init</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--hf-config-path</span>
                                <span class="reference-desc">Hugging Face</span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--enable-prefix-caching</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--worker-address</span>
                                <span class="reference-desc"></span>
                            </div>
                            <div class="reference-item">
                                <span class="reference-param">--controller-address</span>
                                <span class="reference-desc"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="right-panel">
                <div class="right-split-container">
                    <div class="command-section">
                        <div class="command-preview-box">
                            <div class="section-title">
                                <i class="fas fa-terminal"></i> 
                            </div>
                            <div class="command-content" id="commandPreview">""</div>
                        </div>
                        
                        <div class="status-box">
                            <div class="section-title">
                                <i class="fas fa-heartbeat"></i> 
                            </div>
                            <div class="status-content" id="runningStatus"></div>
                        </div>
                        
                        <div class="gpu-status-box" id="gpuStatusBox">
                            <div class="gpu-title">
                                <i class="fas fa-microchip"></i> GPU 
                            </div>
                            <div class="gpu-grid" id="gpuGrid">
                                <div class="gpu-empty">GPU...</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="terminal-section">
                        <div class="terminal-main">
                            <div class="terminal-header">
                                <div class="terminal-title">
                                    <i class="fas fa-terminal"></i> 
                                </div>
                                <button class="clear-btn" onclick="clearTerminal()">
                                    <i class="fas fa-trash-alt"></i> 
                                </button>
                            </div>
                            <div class="terminal-content" id="terminalOutput">
                                ...
                            </div>
                            <div class="terminal-input-area">
                                <input type="text" id="terminalInput" placeholder="Enter..." onkeypress="if(event.key==='Enter')executeTerminalInput()">
                                <button class="run-cmd-btn" onclick="executeTerminalInput()">
                                    <i class="fas fa-paper-plane"></i>
                                    
                                </button>
                            </div>
                            <div class="action-buttons">
                                <button class="btn-generate" onclick="generateCommand()">
                                    <i class="fas fa-cog"></i> 
                                </button>
                                <button class="btn-run" onclick="runCommand()">
                                    <i class="fas fa-play"></i> 
                                </button>
                                <button class="btn-stop" onclick="stopCommand()">
                                    <i class="fas fa-stop"></i> 
                                </button>
                                <button class="btn-save" onclick="saveScheme()">
                                    <i class="fas fa-save"></i> 
                                </button>
                                <button class="btn-exit" onclick="exitApplication()">
                                    <i class="fas fa-power-off"></i> 
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

        <div class="toast-container" id="toastContainer"></div>
        
        <!-- Save Scheme Dialog -->
        <div id="saveSchemeDialog" class="dialog-overlay" style="display: none;" onclick="handleDialogOverlayClick(event)">
            <div class="dialog-content">
                <div class="dialog-header">
                    <h3><i class="fas fa-save"></i> </h3>
                    <button class="dialog-close" onclick="closeSaveSchemeDialog()" title=" Esc ">&times;</button>
                </div>
                <div class="dialog-body">
                    <!-- Scheme Preview Card -->
                    <div class="scheme-preview-card">
                        <div class="scheme-preview-title">
                            <i class="fas fa-info-circle"></i>
                            
                        </div>
                        <div class="scheme-preview-grid">
                            <div class="scheme-preview-item">
                                <i class="fas fa-server"></i>
                                <div>
                                    <span></span>
                                    <strong id="previewModelPath"></strong>
                                </div>
                            </div>
                            <div class="scheme-preview-item">
                                <i class="fas fa-microchip"></i>
                                <div>
                                    <span>GPU </span>
                                    <strong id="previewGpuDevice">0</strong>
                                </div>
                            </div>
                            <div class="scheme-preview-item">
                                <i class="fas fa-layer-group"></i>
                                <div>
                                    <span></span>
                                    <strong id="previewParallel">: 1</strong>
                                </div>
                            </div>
                            <div class="scheme-preview-item">
                                <i class="fas fa-globe"></i>
                                <div>
                                    <span></span>
                                    <strong id="previewEnv">WSL</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dialog-tabs">
                        <button class="dialog-tab active" data-tab="new" onclick="switchSaveTab('new')">
                            <i class="fas fa-plus-circle"></i> 
                        </button>
                        <button class="dialog-tab" data-tab="overwrite" onclick="switchSaveTab('overwrite')">
                            <i class="fas fa-edit"></i> 
                        </button>
                    </div>

                    <!-- New Scheme Tab -->
                    <div id="saveTabNew" class="dialog-tab-content active">
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-tag"></i>
                                
                            </label>
                            <input type="text" id="newSchemeName" class="form-input" placeholder="" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-align-left"></i>
                                 <span style="color: #94a3b8; font-weight: 400;">()</span>
                            </label>
                            <textarea id="newSchemeDesc" class="form-textarea" placeholder="..."></textarea>
                        </div>
                    </div>

                    <!-- Overwrite Tab -->
                    <div id="saveTabOverwrite" class="dialog-tab-content">
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-list"></i>
                                
                            </label>
                            <select id="overwriteSchemeSelect" class="form-select">
                                <option value=""></option>
                            </select>
                        </div>
                        <div class="form-info">
                            <i class="fas fa-exclamation-circle"></i>
                            <span></span>
                        </div>
                    </div>
                </div>
                <div class="dialog-footer">
                    <button class="btn btn-secondary" onclick="closeSaveSchemeDialog()">
                        <i class="fas fa-times"></i> 
                    </button>
                    <button class="btn btn-primary" onclick="confirmSaveScheme()">
                        <i class="fas fa-check"></i> 
                    </button>
                </div>
            </div>
        </div>

        <!-- Command Preview Modal -->
        <div id="commandPreviewModal" class="dialog-overlay" style="display: none;">
            <div class="dialog-content dialog-large">
                <div class="dialog-header">
                    <h3><i class="fas fa-terminal"></i> </h3>
                    <button class="dialog-close" onclick="closeCommandPreviewModal()">&times;</button>
                </div>
                <div class="dialog-body">
                    <div class="scheme-preview-info">
                        <div class="preview-name" id="previewSchemeName"></div>
                        <div class="preview-meta" id="previewSchemeMeta"></div>
                    </div>
                    <div class="command-preview-box">
                        <pre id="previewCommandContent" class="command-content"></pre>
                    </div>
                </div>
                <div class="dialog-footer">
                    <button class="btn btn-secondary" onclick="closeCommandPreviewModal()"></button>
                </div>
            </div>
        </div>

        <!-- Terminal Input Dialog -->
        <div id="terminalInputDialog" class="dialog-overlay" style="display: none;">
            <div class="dialog-content dialog-medium">
                <div class="dialog-header">
                    <h3><i class="fas fa-terminal"></i> </h3>
                    <button class="dialog-close" onclick="closeTerminalInputDialog()">&times;</button>
                </div>
                <div class="dialog-body">
                    <div class="form-group">
                        <label class="form-label"></label>
                        <textarea id="terminalCommandInput" class="form-textarea" placeholder="..."></textarea>
                    </div>
                </div>
                <div class="dialog-footer">
                    <button class="btn btn-secondary" onclick="closeTerminalInputDialog()"></button>
                    <button class="btn btn-primary" onclick="executeTerminalCommand()">
                        <i class="fas fa-paper-plane"></i> 
                    </button>
                </div>
            </div>
        </div>
        
        <script>
            // Global state
            let currentEnv = 'wsl';
            let currentCondaPath = '';  // Initialize with default value
            let customParams = [];
            let currentScheme = null;
            let schemes = [];
            let process = null;
            let isRunning = false;
            let socket = null;
            let saveSchemeTab = 'new';
            
            // Initialize schemes from server
            (async function loadSchemesFromServer() {
                try {
                    const response = await fetch('/api/schemes');
                    if (response.ok) {
                        const data = await response.json();
                        schemes = data.schemes || [];
                        updateSchemeList();
                        console.log(`Loaded ${schemes.length} schemes from server`);
                    }
                } catch (e) {
                    console.log('Could not load schemes from server:', e);
                    schemes = [];
                }
            })();
        
        // Initialize environment and conda detection
        (async function initEnvironment() {
            try {
                // Detect environment via API
                const envResponse = await fetch('/api/detect-environment');
                if (envResponse.ok) {
                    const envData = await envResponse.json();
                    currentEnv = envData.environment || 'linux';
                    document.querySelectorAll('.env-btn').forEach(btn => {
                        btn.classList.toggle('active', btn.dataset.env === currentEnv);
                    });
                    console.log(`Detected environment: ${currentEnv}`);
                }
                
                // Detect conda path
                const condaResponse = await fetch('/api/detect-conda');
                if (condaResponse.ok) {
                    const condaData = await condaResponse.json();
                    currentCondaPath = condaData.conda_path;
                    console.log(`Detected conda path: ${currentCondaPath}`);
                    // Update conda path input if it exists
                    const condaPathInput = document.getElementById('condaPath');
                    if (condaPathInput && !condaPathInput.value) {
                        condaPathInput.value = currentCondaPath;
                    }
                }
            } catch (e) {
                console.log('Could not detect conda from server:', e);
            }
        })();
        
        const log = (message, type = 'info') => {
            const terminal = document.getElementById('terminalOutput');
            const line = document.createElement('div');
            line.className = `terminal-line ${type} new-line`;
            line.textContent = message;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;

            setTimeout(() => {
                line.classList.remove('new-line');
            }, 2000);
        };

        const showToast = (message, type = 'info') => {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'times-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i> ${message}`;
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.animation = 'toastOut 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards';
                setTimeout(() => toast.remove(), 400);
            }, 3000);
        };

        const switchTab = (element, tabName) => {
            document.querySelectorAll('.panel-tab').forEach(tab => { tab.classList.remove('active'); });
            document.querySelectorAll('.tab-pane').forEach(pane => { pane.classList.remove('active'); });
            element.classList.add('active');
            document.getElementById(`tab-${tabName}`).classList.add('active');
        };

        const selectEnv = (env) => {
            currentEnv = env;
            document.querySelectorAll('.env-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.env === env);
            });
            // LinuxWSL
            const wslPathRow = document.getElementById('wslPathRow');
            if (wslPathRow) {
                wslPathRow.style.display = env === 'linux' ? 'none' : 'flex';
            }
            log(`${env === 'wsl' ? 'WSL' : 'Linux'}`, 'info');
        };

        const validateInput = (input, hintId) => {
            const hint = document.getElementById(hintId);
            if (!hint) return;
            
            const value = input.value.trim();
            if (!value) {
                hint.className = 'param-hint';
                hint.textContent = '';
                return;
            }
            
            // Conda
            if (input.id === 'condaEnv') {
                if (/^[a-zA-Z0-9_.-]+$/.test(value)) {
                    hint.className = 'param-hint valid';
                    hint.textContent = ' ';
                } else {
                    hint.className = 'param-hint error';
                    hint.textContent = ' ';
                }
                return;
            }
            
            // 
            if (input.id === 'modelPath') {
                if (value.includes('/mnt/') || value.includes('~') || value.startsWith('/')) {
                    hint.className = 'param-hint valid';
                    hint.textContent = ' ';
                } else if (value.includes(':\\')) {
                    hint.className = 'param-hint warning';
                    hint.textContent = ' Windows/mnt/';
                } else {
                    hint.className = 'param-hint warning';
                    hint.textContent = ' /mnt/';
                }
                return;
            }
            
            // 
            if (input.id === 'port') {
                const port = parseInt(value);
                if (port >= 1 && port <= 65535 && Number.isInteger(port)) {
                    hint.className = 'param-hint valid';
                    hint.textContent = ' ';
                } else {
                    hint.className = 'param-hint error';
                    hint.textContent = ' 1-65535';
                }
                return;
            }
            
            // CUDA
            if (input.id === 'cudaDevices') {
                const devices = value.split(',').map(d => d.trim());
                const valid = devices.every(d => /^\d+$/.test(d));
                if (valid && devices.length > 0) {
                    hint.className = 'param-hint valid';
                    hint.textContent = `  ${devices.length} GPU`;
                } else if (!value) {
                    hint.className = 'param-hint warning';
                    hint.textContent = ' ';
                } else {
                    hint.className = 'param-hint error';
                    hint.textContent = ' 0,1,2,3';
                }
                return;
            }
            
            // 
            hint.className = 'param-hint';
            hint.textContent = '';
        };

        const addCustomParam = () => {
            const container = document.getElementById('customParamsContainer');
            const row = document.createElement('div');
            row.className = 'custom-param-row';
            row.innerHTML = `
                <input type="text" placeholder=" (: --max-num-batched-tokens)" class="param-name">
                <input type="text" placeholder="" class="param-value">
                <label class="flag-checkbox">
                    <input type="checkbox"> 
                </label>
                <button class="remove-param-btn" onclick="removeCustomParam(this)">
                    <i class="fas fa-times"></i>
                </button>
            `;
            container.appendChild(row);
        };

        const removeCustomParam = (button) => {
            button.parentElement.remove();
        };

        const collectCustomParams = () => {
            const rows = document.querySelectorAll('#customParamsContainer .custom-param-row');
            const params = [];
            rows.forEach(row => {
                const name = row.querySelector('.param-name').value.trim();
                const value = row.querySelector('.param-value').value.trim();
                const isFlag = row.querySelector('.flag-checkbox input').checked;
                if (name) {
                    params.push({ name, value, isFlag });
                }
            });
            return params;
        };

        const collectQuickParams = () => {
            const rows = document.querySelectorAll('#gpuQuickParamsContainer .quick-param-row');
            const params = [];
            rows.forEach(row => {
                const name = row.querySelector('.quick-param-name').value.trim();
                const value = row.querySelector('.quick-param-value').value.trim();
                if (name) {
                    params.push({ name, value, isFlag: !value });
                }
            });
            return params;
        };

        const getConfig = () => {
            const isLinux = currentEnv === 'linux';
            return {
                wslPath: isLinux ? '' : (document.getElementById('wslPath').value.trim() || 'wsl'),
                condaEnv: document.getElementById('condaEnv').value.trim() || 'vllm',
                condaPath: document.getElementById('condaPath').value.trim(),
                envType: currentEnv,
                cudaDevices: document.getElementById('cudaDevices').value.trim(),
                tensorParallel: parseInt(document.getElementById('tensorParallel').value) || 1,
                pipelineParallelSize: parseInt(document.getElementById('pipelineParallelSize').value) || 1,
                modelPath: document.getElementById('modelPath').value.trim(),
                quantization: document.getElementById('quantization').value,
                dtype: document.getElementById('dtype').value,
                maxModelLen: document.getElementById('maxModelLen').value.trim(),
                host: document.getElementById('host').value.trim() || '0.0.0.0',
                port: parseInt(document.getElementById('port').value) || 8000,
                gpuMemoryUtilization: parseFloat(document.getElementById('gpuMemoryUtilization').value) || 0.9,
                maxNumSequences: parseInt(document.getElementById('maxNumSequences').value) || 256,
                maxNumBatchedTokens: parseInt(document.getElementById('maxNumBatchedTokens').value) || 8192,
                servedModelName: document.getElementById('servedModelName').value.trim(),
                chatTemplate: document.getElementById('chatTemplate').value.trim(),
                toolCallParser: document.getElementById('toolCallParser').value.trim(),
                reasoningParser: document.getElementById('reasoningParser').value.trim(),
                trustRemoteCode: document.getElementById('trustRemoteCode').checked,
                enableExpertParallel: document.getElementById('enableExpertParallel').checked,
                enableAutoToolChoice: document.getElementById('enableAutoToolChoice').checked,
                asyncScheduling: document.getElementById('asyncScheduling').checked,
                customParams: collectCustomParams(),
                quickParams: collectQuickParams()
            };
        };

        const loadConfig = (config) => {
            if (!config) return;
            const envType = config.envType || 'wsl';
            selectEnv(envType);
            document.getElementById('wslPath').value = config.wslPath || '';
            document.getElementById('condaEnv').value = config.condaEnv || '';
            document.getElementById('condaPath').value = config.condaPath || '';
            document.getElementById('cudaDevices').value = config.cudaDevices || '';
            document.getElementById('tensorParallel').value = config.tensorParallel || 1;
            document.getElementById('pipelineParallelSize').value = config.pipelineParallelSize || 1;
            document.getElementById('modelPath').value = config.modelPath || '';
            document.getElementById('quantization').value = config.quantization || '';
            document.getElementById('dtype').value = config.dtype || 'auto';
            document.getElementById('maxModelLen').value = config.maxModelLen || '';
            document.getElementById('host').value = config.host || '0.0.0.0';
            document.getElementById('port').value = config.port || 8000;
            document.getElementById('gpuMemoryUtilization').value = config.gpuMemoryUtilization || 0.9;
            document.getElementById('maxNumSequences').value = config.maxNumSequences || 256;
            document.getElementById('maxNumBatchedTokens').value = config.maxNumBatchedTokens || 8192;
            document.getElementById('servedModelName').value = config.servedModelName || '';
            document.getElementById('chatTemplate').value = config.chatTemplate || '';
            document.getElementById('toolCallParser').value = config.toolCallParser || '';
            document.getElementById('reasoningParser').value = config.reasoningParser || '';
            document.getElementById('trustRemoteCode').checked = config.trustRemoteCode || false;
            document.getElementById('enableExpertParallel').checked = config.enableExpertParallel || false;
            document.getElementById('enableAutoToolChoice').checked = config.enableAutoToolChoice || false;
            document.getElementById('asyncScheduling').checked = config.asyncScheduling || false;
            
            const container = document.getElementById('customParamsContainer');
            container.innerHTML = '';
            if (config.customParams && config.customParams.length > 0) {
                config.customParams.forEach(param => {
                    const row = document.createElement('div');
                    row.className = 'custom-param-row';
                    row.innerHTML = `
                        <input type="text" placeholder="" class="param-name" value="${param.name}">
                        <input type="text" placeholder="" class="param-value" value="${param.value}">
                        <label class="flag-checkbox">
                            <input type="checkbox" ${param.isFlag ? 'checked' : ''}> 
                        </label>
                        <button class="remove-param-btn" onclick="removeCustomParam(this)">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                    container.appendChild(row);
                });
            } else {
                addCustomParam();
            }

            // Load quick params
            const quickContainer = document.getElementById('gpuQuickParamsContainer');
            const quickRows = quickContainer.querySelectorAll('.quick-param-row');
            const savedQuickParams = config.quickParams || [];
            quickRows.forEach((row, index) => {
                const nameInput = row.querySelector('.quick-param-name');
                const valueInput = row.querySelector('.quick-param-value');
                if (savedQuickParams[index]) {
                    const param = savedQuickParams[index];
                    nameInput.value = param.name || '';
                    valueInput.value = param.value || '';
                } else {
                    nameInput.value = '';
                    valueInput.value = '';
                }
            });

            if (config.envType) {
                selectEnv(config.envType);
            }
        };

        window.generateCommand = async (configOverride) => {
            const config = configOverride || getConfig();
            // Note: No longer validating modelPath - allow command generation even with errors
            // as requested in optimization item 5

            let command = '';
            const parts = [];

            if (currentEnv === 'wsl') {
                const wslPath = config.wslPath || 'wsl';
                // Build command to run inside WSL using conda environment's python directly
                const condaEnv = config.condaEnv || 'vllm';
                const cudaDevices = config.cudaDevices;
                
                // Build WSL command - use conda environment's python directly
                const wslCmd = [];
                
                wslCmd.push(`source /etc/profile 2>/dev/null || true`);
                wslCmd.push(`source ~/.bashrc 2>/dev/null || true`);
                
                // Use conda run to execute vLLM - this avoids hardcoding conda paths
                // The conda run command will use the conda environment's python automatically
                // We don't need to source conda.sh or use hardcoded python paths
                // Just use 'conda run -n {condaEnv} python -m vllm.entrypoints.openai.api_server'
                
                // conda
                let effectiveCondaPath = '';
                try {
                    const validateResponse = await fetch('/api/validate-conda-path', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            condaPath: config.condaPath || '',
                            envType: currentEnv || 'wsl'
                        })
                    });
                    if (validateResponse.ok) {
                        const validateData = await validateResponse.json();
                        effectiveCondaPath = validateData.path || '';
                        if (!validateData.valid) {
                            console.log(validateData.message);
                            // currentCondaPath
                            currentCondaPath = effectiveCondaPath;
                            // conda
                            showToast('Conda: ' + effectiveCondaPath, 'warning');
                        }
                    } else {
                        // API
                        console.log('API returned error, using currentCondaPath');
                        effectiveCondaPath = currentCondaPath || '';
                    }
                } catch (e) {
                    console.error('Failed to validate conda path:', e);
                    // 
                    effectiveCondaPath = currentCondaPath || '';
                }
                
                // 
                if (!effectiveCondaPath) {
                    effectiveCondaPath = config.condaPath || currentCondaPath || '';
                }
                
                if (effectiveCondaPath) {
                    wslCmd.push(`source ${effectiveCondaPath}/etc/profile.d/conda.sh 2>/dev/null || true`);
                    // source activateconda activate
                    wslCmd.push(`source ${effectiveCondaPath}/bin/activate ${condaEnv}`);
                } else {
                    // condaPathconda activate
                    wslCmd.push(`conda activate ${condaEnv}`);
                }
                
                // Add CUDA_VISIBLE_DEVICES export AFTER setting up conda
                if (cudaDevices) {
                    wslCmd.push(`export CUDA_VISIBLE_DEVICES=${cudaDevices}`);
                }
                
                // Add quick params AFTER conda activate, BEFORE vllm serve
                const quickParams = config.quickParams || [];
                quickParams.forEach(param => {
                    if (param.name) {
                        if (param.isFlag) {
                            wslCmd.push(param.name);
                        } else if (param.value) {
                            wslCmd.push(`${param.name} ${param.value}`);
                        } else {
                            wslCmd.push(param.name);
                        }
                    }
                });
                
                // Build vLLM arguments (excluding --model which becomes positional)
                const vllmArgs = [];
                vllmArgs.push(`--host ${config.host}`);
                vllmArgs.push(`--port ${config.port}`);
                vllmArgs.push(`--tensor-parallel-size ${config.tensorParallel}`);
                if (config.pipelineParallelSize && config.pipelineParallelSize !== 1) {
                    vllmArgs.push(`--pipeline-parallel-size ${config.pipelineParallelSize}`);
                }
                vllmArgs.push(`--gpu-memory-utilization=${config.gpuMemoryUtilization}`);
                vllmArgs.push(`--max-num-seqs ${config.maxNumSequences}`);

                if (config.quantization) {
                    vllmArgs.push(`--quantization ${config.quantization}`);
                }
                if (config.dtype && config.dtype !== 'auto') {
                    vllmArgs.push(`--dtype ${config.dtype}`);
                }
                if (config.maxModelLen) {
                    vllmArgs.push(`--max-model-len ${config.maxModelLen}`);
                }
                if (config.servedModelName) {
                    vllmArgs.push(`--served-model-name ${config.servedModelName}`);
                }
                if (config.chatTemplate) {
                    vllmArgs.push(`--chat-template "${config.chatTemplate}"`);
                }
                if (config.trustRemoteCode) {
                    vllmArgs.push(`--trust-remote-code`);
                }
                if (config.enableExpertParallel) {
                    vllmArgs.push(`--enable-expert-parallel`);
                }
                if (config.enableAutoToolChoice) {
                    vllmArgs.push(`--enable-auto-tool-choice`);
                }
                if (config.asyncScheduling) {
                    vllmArgs.push(`--async-scheduling`);
                }
                if (config.toolCallParser) {
                    vllmArgs.push(`--tool-call-parser ${config.toolCallParser}`);
                }
                if (config.reasoningParser) {
                    vllmArgs.push(`--reasoning-parser ${config.reasoningParser}`);
                }

                // Add custom params
                const customParams = config.customParams || [];
                customParams.forEach(param => {
                    if (param.name) {
                        if (param.isFlag) {
                            vllmArgs.push(param.name);
                        } else if (param.value) {
                            vllmArgs.push(`${param.name} ${param.value}`);
                        } else {
                            vllmArgs.push(param.name);
                        }
                    }
                });
                
                // Build vllm serve command with model path as positional argument
                // Allow empty model path as per optimization requirement
                const modelPath = config.modelPath || '';
                let vllmServeCmd = `vllm serve "${modelPath}" ${vllmArgs.join(' ')}`;
                
                // Add the complete vLLM command as a single entry
                wslCmd.push(vllmServeCmd);
                
                // Construct full command - use && to connect setup commands, vLLM is last
                command = `${wslPath} bash -c "${wslCmd.join(' && ')}"`;
                
                parts.push(`wsl-path: ${wslPath}`);
                parts.push(`conda-env: ${condaEnv}`);
                if (cudaDevices) {
                    parts.push(`cuda-devices: ${cudaDevices}`);
                }
            } else {
                // Linux:  /bin/bash -c 
                // Use empty string as default, let backend auto-detect conda path
                const condaPath = config.condaPath || currentCondaPath || '';
                const exportPart = config.cudaDevices ? `export CUDA_VISIBLE_DEVICES=${config.cudaDevices}` : '';
                
                // Build quick params
                const quickParams = config.quickParams || [];
                let quickParamsParts = [];
                quickParams.forEach(param => {
                    if (param.name) {
                        if (param.isFlag) {
                            quickParamsParts.push(param.name);
                        } else if (param.value) {
                            quickParamsParts.push(`${param.name} ${param.value}`);
                        } else {
                            quickParamsParts.push(param.name);
                        }
                    }
                });
                
                // Build vllm serve command
                // Build vLLM arguments (excluding --model which becomes positional)
                const vllmArgs = [];
                vllmArgs.push(`--host ${config.host}`);
                vllmArgs.push(`--port ${config.port}`);
                vllmArgs.push(`--tensor-parallel-size ${config.tensorParallel}`);
                if (config.pipelineParallelSize && config.pipelineParallelSize !== 1) {
                    vllmArgs.push(`--pipeline-parallel-size ${config.pipelineParallelSize}`);
                }
                vllmArgs.push(`--gpu-memory-utilization=${config.gpuMemoryUtilization}`);
                vllmArgs.push(`--max-num-seqs ${config.maxNumSequences}`);

                if (config.quantization) {
                    vllmArgs.push(`--quantization ${config.quantization}`);
                }
                if (config.dtype && config.dtype !== 'auto') {
                    vllmArgs.push(`--dtype ${config.dtype}`);
                }
                if (config.maxModelLen) {
                    vllmArgs.push(`--max-model-len ${config.maxModelLen}`);
                }
                if (config.servedModelName) {
                    vllmArgs.push(`--served-model-name ${config.servedModelName}`);
                }
                if (config.chatTemplate) {
                    vllmArgs.push(`--chat-template "${config.chatTemplate}"`);
                }
                if (config.trustRemoteCode) {
                    vllmArgs.push(`--trust-remote-code`);
                }
                if (config.enableAutoToolChoice) {
                    vllmArgs.push(`--enable-auto-tool-choice`);
                }
                if (config.asyncScheduling) {
                    vllmArgs.push(`--async-scheduling`);
                }
                if (config.toolCallParser) {
                    vllmArgs.push(`--tool-call-parser ${config.toolCallParser}`);
                }
                if (config.reasoningParser) {
                    vllmArgs.push(`--reasoning-parser ${config.reasoningParser}`);
                }

                // Add custom params
                const customParams = config.customParams || [];
                customParams.forEach(param => {
                    if (param.name) {
                        if (param.isFlag) {
                            vllmArgs.push(param.name);
                        } else if (param.value) {
                            vllmArgs.push(`${param.name} ${param.value}`);
                        } else {
                            vllmArgs.push(param.name);
                        }
                    }
                });
                
                // Build vllm serve command with model path as positional argument
                // Allow empty model path as per optimization requirement
                const modelPath = config.modelPath || '';
                let vllmCmd = `vllm serve "${modelPath}" ${vllmArgs.join(' ')}`;

                // Build complete command in single line format for subprocess
                let allParts = [];
                // Use conda run - no need for hardcoded python paths or conda activate
                
                // conda
                let effectiveCondaPath = '';
                try {
                    const validateResponse = await fetch('/api/validate-conda-path', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            condaPath: config.condaPath || '',
                            envType: currentEnv || 'linux'
                        })
                    });
                    if (validateResponse.ok) {
                        const validateData = await validateResponse.json();
                        effectiveCondaPath = validateData.path || '';
                        if (!validateData.valid) {
                            console.log(validateData.message);
                            // currentCondaPath
                            currentCondaPath = effectiveCondaPath;
                        }
                    } else {
                        console.log('API returned error, using currentCondaPath');
                        effectiveCondaPath = currentCondaPath || '';
                    }
                } catch (e) {
                    console.error('Failed to validate conda path:', e);
                    effectiveCondaPath = config.condaPath || currentCondaPath || '';
                }
                
                if (!effectiveCondaPath) {
                    effectiveCondaPath = config.condaPath || currentCondaPath || '';
                }
                
                if (effectiveCondaPath) {
                    allParts.push(`source ${effectiveCondaPath}/etc/profile.d/conda.sh 2>/dev/null || true`);
                    // source activateconda activate
                    allParts.push(`source ${effectiveCondaPath}/bin/activate ${config.condaEnv}`);
                } else {
                    // condaPathconda activate
                    allParts.push(`conda activate ${config.condaEnv}`);
                }
                
                if (exportPart) allParts.push(exportPart);
                allParts.push(...quickParamsParts);
                allParts.push(vllmCmd);
                
                command = `/bin/bash -c "${allParts.join(' && ')}"`;
                parts.push(`env: linux`);
                parts.push(`conda-env: ${config.condaEnv}`);
                if (config.cudaDevices) {
                    parts.push(`cuda-devices: ${config.cudaDevices}`);
                }
            }

            const previewText = `[vLLM ]
: ${config.modelPath}
: ${currentEnv === 'wsl' ? 'WSL' : 'Linux'}
: ${config.port}
CUDA: ${config.cudaDevices || ''}
: ${config.tensorParallel} GPU
: ${config.gpuMemoryUtilization * 100}%

${command}`;

            document.getElementById('commandPreview').textContent = previewText;
            log('', 'success');
            showToast('', 'success');
            return command;
        };

        const runCommand = async () => {
            if (isRunning) {
                showToast('', 'warning');
                return;
            }

            const command = await generateCommand();
            if (!command) {
                showToast('', 'warning');
                return;
            }

            isRunning = true;
            document.getElementById('runningStatus').innerHTML = '<span style="color: #f59e0b;">...</span>';
        document.getElementById('runningStatus').className = 'status-content running';
            document.getElementById('runningStatus').className = 'status-content running';
            document.getElementById('statusText').textContent = '';
            document.getElementById('statusDot').classList.add('running');

            document.querySelectorAll('.action-buttons button').forEach(btn => {
                if (btn.classList.contains('btn-run')) {
                    btn.disabled = true;
                }
            });

            document.querySelector('.terminal-section')?.classList.add('running');
            document.querySelector('.status-box')?.classList.add('running');
            document.querySelector('.command-preview-box')?.classList.add('running');

            try {
                log('vLLM...', 'info');
                log(`: ${command}`, 'info');
                const response = await fetch('/api/run', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        command: command,
                        envType: currentEnv,
                        wslPath: document.getElementById('wslPath').value.trim() || 'wsl'
                    })
                });

                const result = await response.json();
                if (result.success) {
                    // Don't show success yet - wait for WebSocket status update
                    // The actual startup confirmation comes from the subprocess output via WebSocket
                    log('vLLM...', 'info');
                } else {
                    throw new Error(result.message || '');
                }
            } catch (error) {
                log(`: ${error.message}`, 'error');
                document.getElementById('runningStatus').innerHTML = '<span style="color: #ef4444; font-weight: 600;"></span>';
        document.getElementById('runningStatus').className = 'status-content error';
                document.getElementById('runningStatus').className = 'status-content error';
                document.getElementById('statusText').textContent = '';
                document.getElementById('statusDot').classList.remove('running');
                document.getElementById('statusDot').classList.add('error');
                showToast(`: ${error.message}`, 'error');
                isRunning = false;

                document.querySelectorAll('.action-buttons button').forEach(btn => {
                    btn.disabled = false;
                });

                document.querySelector('.terminal-section')?.classList.remove('running');
                document.querySelector('.status-box')?.classList.remove('running');
                document.querySelector('.command-preview-box')?.classList.remove('running');
            }
        };

        const stopCommand = async () => {
            if (!isRunning) {
                showToast('', 'warning');
                return;
            }

            try {
                const response = await fetch('/api/stop', { method: 'POST' });
                const result = await response.json();

                if (result.success) {
                    log('vLLM...', 'warning');
                    // Set stopping status
                    document.getElementById('runningStatus').innerHTML = '<span style="color: #f97316;">...</span>';
        document.getElementById('runningStatus').className = 'status-content stopping';
                    document.getElementById('runningStatus').className = 'status-content stopping';
                    document.getElementById('statusText').textContent = '';
                    document.getElementById('statusDot').classList.remove('running');
                    document.getElementById('statusDot').classList.add('stopping');

                    isRunning = false;
                    stopGPUPolling(); // Stop GPU monitoring

                    // After a brief delay, show stopped status
                    setTimeout(() => {
                        document.getElementById('runningStatus').innerHTML = '<span style="color: #22c55e;"></span>';
        document.getElementById('runningStatus').className = 'status-content ready';
                        document.getElementById('runningStatus').className = 'status-content';
                        document.getElementById('statusText').textContent = '';
                        document.getElementById('statusDot').classList.remove('stopping');
                    }, 1500);
                    showToast('', 'info');

                    document.querySelector('.terminal-section')?.classList.remove('running');
                    document.querySelector('.status-box')?.classList.remove('running');
                    document.querySelector('.command-preview-box')?.classList.remove('running');
                    document.getElementById('gpuStatusBox')?.classList.remove('running');

                    // GPU#11
                    log('GPU...', 'info');
                    setTimeout(() => {
                        startGPUPolling();
                        log('GPU', 'success');
                    }, 1000);
                }
            } catch (error) {
                log(`: ${error.message}`, 'error');
                showToast(`: ${error.message}`, 'error');
            }

            document.querySelectorAll('.action-buttons button').forEach(btn => {
                btn.disabled = false;
            });
        };

        const clearTerminal = () => {
            document.getElementById('terminalOutput').innerHTML = '...';
            log('', 'system');
        };

        const executeTerminalInput = async () => {
            const input = document.getElementById('terminalInput');
            const command = input.value.trim();

            if (!command) {
                showToast('', 'warning');
                return;
            }

            // Log the command
            log(`$ ${command}`, 'input');
            input.value = '';

            // Send command to server for execution in new terminal
            try {
                const response = await fetch('/api/execute', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ command, env: currentEnv })
                });
                const result = await response.json();
                if (result.success) {
                    log(result.output, 'system');
                } else {
                    log(`: ${result.error}`, 'error');
                }
            } catch (error) {
                log(`: ${error.message}`, 'error');
            }
        };

        const showTerminalInputDialog = () => {
            document.getElementById('terminalCommandInput').value = '';
            document.getElementById('terminalInputDialog').style.display = 'flex';
        };

        const closeTerminalInputDialog = () => {
            document.getElementById('terminalInputDialog').style.display = 'none';
        };

        const closeCommandPreviewModal = () => {
            document.getElementById('commandPreviewModal').style.display = 'none';
        };

        const executeTerminalCommand = async () => {
            const command = document.getElementById('terminalCommandInput').value.trim();
            if (!command) {
                showToast('', 'warning');
                return;
            }

            closeTerminalInputDialog();
            log(`: ${command}`, 'info');

            try {
                const response = await fetch('/api/execute', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ command, env: currentEnv })
                });
                const result = await response.json();
                if (result.success) {
                    log(result.output, 'command');
                    showToast('', 'success');
                } else {
                    log(`: ${result.error}`, 'error');
                    showToast(`: ${result.error}`, 'error');
                }
            } catch (error) {
                log(`: ${error.message}`, 'error');
                showToast(`: ${error.message}`, 'error');
            }
        };

        const generateShScript = (config, command) => {
            const modelName = config.modelPath.split('/').pop() || 'model';
            const envName = config.condaEnv || 'vllm';
            
            // Build export commands
            let exports = '';
            if (config.cudaDevices) {
                exports += `export CUDA_VISIBLE_DEVICES=${config.cudaDevices}\n`;
            }
            
            // Add quick params as exports
            const quickParams = config.quickParams || [];
            quickParams.forEach(param => {
                if (param.name && param.value) {
                    exports += `export ${param.name}=${param.value}\n`;
                }
            });
            
            // Build vllm serve command
            // Use python -m vllm.entrypoints.openai.api_server instead of 'vllm serve' for conda run compatibility
            const modelPath = config.modelPath || '';
            let vllmArgs = `python -m vllm.entrypoints.openai.api_server --model "${modelPath}"`;
            vllmArgs += ` --host ${config.host}`;
            vllmArgs += ` --port ${config.port}`;
            vllmArgs += ` --tensor-parallel-size ${config.tensorParallel}`;
            vllmArgs += ` --gpu-memory-utilization=${config.gpuMemoryUtilization}`;
            vllmArgs += ` --max-num-seqs ${config.maxNumSequences}`;
            
            if (config.quantization) vllmArgs += ` --quantization ${config.quantization}`;
            if (config.dtype && config.dtype !== 'auto') vllmArgs += ` --dtype ${config.dtype}`;
            if (config.maxModelLen) vllmArgs += ` --max-model-len ${config.maxModelLen}`;
            if (config.servedModelName) vllmArgs += ` --served-model-name ${config.servedModelName}`;
            if (config.chatTemplate) vllmArgs += ` --chat-template "${config.chatTemplate}"`;
            if (config.trustRemoteCode) vllmArgs += ` --trust-remote-code`;
            if (config.enableExpertParallel) vllmArgs += ` --enable_expert_parallel`;
            if (config.enableAutoToolChoice) vllmArgs += ` --enable-auto-tool-choice`;
            if (config.asyncScheduling) vllmArgs += ` --async-scheduling`;
            if (config.toolCallParser) vllmArgs += ` --tool-call-parser ${config.toolCallParser}`;
            if (config.reasoningParser) vllmArgs += ` --reasoning-parser ${config.reasoningParser}`;
            
            // Add custom params at the end
            const customParams = config.customParams || [];
            customParams.forEach(param => {
                if (param.name) {
                    if (param.isFlag) {
                        vllmArgs += ` ${param.name}`;
                    } else if (param.value) {
                        vllmArgs += ` ${param.name} ${param.value}`;
                    } else {
                        vllmArgs += ` ${param.name}`;
                    }
                }
            });
            
            return `#!/bin/bash
# vLLM Server Startup Script
# Generated by VLLM GUI
# Model: ${config.modelPath}
# Created: ${new Date().toLocaleString('zh-CN')}

# Set environment variables
${exports}# Use conda environment's python directly - no need for conda activate
source ~/miniconda3/etc/profile.d/conda.sh 2>/dev/null || true
PYTHON_PATH=~/miniconda3/envs/${envName}/bin/python

# Start vLLM server
echo "Starting vLLM server..."
echo "Model: ${config.modelPath}"
echo "Port: ${config.port}"
echo "Tensor Parallel: ${config.tensorParallel}"
${vllmArgs.replace('python -m', '$PYTHON_PATH -m')}
`;
        };

        // Dialog functions for save scheme modal
        const showSaveSchemeDialog = () => {
            const dialog = document.getElementById('saveSchemeDialog');
            const nameInput = document.getElementById('newSchemeName');
            const descInput = document.getElementById('newSchemeDesc');
            const overwriteSelect = document.getElementById('overwriteSchemeSelect');

            // Generate suggested name from current config
            const config = getConfig();
            let suggestedName = config.servedModelName || '';
            if (!suggestedName && config.modelPath) {
                suggestedName = config.modelPath.split('/').pop().split('\\').pop();
            }
            if (!suggestedName) {
                suggestedName = `vllm__${new Date().toLocaleDateString()}`;
            }
            nameInput.value = suggestedName;
            descInput.value = '';

            // Update preview card with current config
            const modelPathEl = document.getElementById('previewModelPath');
            const gpuDeviceEl = document.getElementById('previewGpuDevice');
            const parallelEl = document.getElementById('previewParallel');
            const envEl = document.getElementById('previewEnv');

            if (modelPathEl) {
                modelPathEl.textContent = config.modelPath ?
                    (config.modelPath.length > 30 ? '...' + config.modelPath.slice(-27) : config.modelPath) : '';
            }
            if (gpuDeviceEl) {
                gpuDeviceEl.textContent = config.cudaDevices || '0';
            }
            if (parallelEl) {
                parallelEl.textContent = `: ${config.tensorParallel || 1}`;
            }
            if (envEl) {
                envEl.textContent = currentEnv === 'wsl' ? 'WSL' : (currentEnv === 'linux' ? 'Linux' : currentEnv);
            }

            // Populate overwrite dropdown with existing schemes
            overwriteSelect.innerHTML = '<option value=""></option>' +
                schemes.map(s => `<option value="${s.id}">${s.name}</option>`).join('');

            // Reset to new tab
            switchSaveTab('new');

            dialog.style.display = 'flex';

            // Add keyboard event listener for ESC and Enter
            setTimeout(() => {
                dialog.addEventListener('keydown', handleDialogKeydown);
                nameInput?.focus();
            }, 100);
        };

        const handleDialogKeydown = (e) => {
            if (e.key === 'Escape') {
                closeSaveSchemeDialog();
            } else if (e.key === 'Enter') {
                const activeTab = document.querySelector('.dialog-tab.active')?.dataset.tab;
                if (activeTab === 'new') {
                    const name = document.getElementById('newSchemeName')?.value.trim();
                    if (name) {
                        confirmSaveScheme();
                    }
                }
            }
        };

        const handleDialogOverlayClick = (e) => {
            if (e.target.id === 'saveSchemeDialog') {
                closeSaveSchemeDialog();
            }
        };

        const closeSaveSchemeDialog = () => {
            const dialog = document.getElementById('saveSchemeDialog');
            dialog.style.display = 'none';
            // Remove keyboard event listener
            if (dialog) {
                dialog.removeEventListener('keydown', handleDialogKeydown);
            }
        };

        const switchSaveTab = (tab) => {
            document.querySelectorAll('.dialog-tab').forEach(t => { t.classList.remove('active'); });
            document.querySelectorAll('.dialog-tab-content').forEach(c => { c.classList.remove('active'); });

            const tabButton = document.querySelector(`[data-tab="${tab}"]`);
            const tabContent = document.getElementById(`saveTab${tab.charAt(0).toUpperCase() + tab.slice(1)}`);
            
            if (tabButton) tabButton.classList.add('active');
            if (tabContent) tabContent.classList.add('active');
        };

        const confirmSaveScheme = async () => {
            const activeTab = document.querySelector('.dialog-tab.active').dataset.tab;

            if (activeTab === 'new') {
                const name = document.getElementById('newSchemeName').value.trim();
                const desc = document.getElementById('newSchemeDesc').value.trim();

                if (!name) {
                    showToast('', 'warning');
                    return;
                }

                const config = getConfig();
                config.envType = currentEnv;

                try {
                    const response = await fetch('/api/schemes', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            scheme: {
                                name: name,
                                config: config,
                                envType: currentEnv
                            }
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        // Update local schemes list
                        const existingIndex = schemes.findIndex(s => s.name === name);
                        if (existingIndex !== -1) {
                            schemes[existingIndex] = result.scheme;
                            showToast(` "${name}" `, 'success');
                            log(` "${name}" `, 'success');
                        } else {
                            schemes.push(result.scheme);
                            showToast(` "${name}" `, 'success');
                            log(` "${name}" `, 'success');
                        }
                        updateSchemeList();
                        closeSaveSchemeDialog();
                    } else {
                        showToast(result.message || '', 'error');
                    }
                } catch (e) {
                    showToast(': ' + e.message, 'error');
                }

            } else {
                // Overwrite existing scheme
                const select = document.getElementById('overwriteSchemeSelect');
                const schemeId = parseInt(select.value);

                if (!schemeId) {
                    showToast('', 'warning');
                    return;
                }

                const schemeIndex = schemes.findIndex(s => s.id === schemeId);
                if (schemeIndex === -1) return;

                const config = getConfig();
                config.envType = currentEnv;

                schemes[schemeIndex] = {
                    id: schemes[schemeIndex].id,
                    name: schemes[schemeIndex].name,
                    config: config,
                    createdAt: new Date().toISOString(),
                    envType: currentEnv
                };

                updateSchemeList();
                showToast(` "${schemes[schemeIndex].name}" `, 'success');
                log(` "${schemes[schemeIndex].name}" `, 'success');
                closeSaveSchemeDialog();
            }
        };

        window.saveScheme = async () => {
            showSaveSchemeDialog();
        };

        const updateSchemeList = () => {
            const popup = document.getElementById('schemeListPopup');
            const countBadge = document.getElementById('schemeCountBadge');
            const count = schemes.length;
            
            if (countBadge) {
                countBadge.textContent = count;
                countBadge.setAttribute('data-count', count);
            }
            
            if (!popup) return;
            
            popup.innerHTML = schemes.length ? `
                <div style="padding: 12px 20px; background: rgba(102, 126, 234, 0.1); border-bottom: 2px solid rgba(102, 126, 234, 0.2); display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-weight: 700; color: #667eea; font-size: 0.9em;">
                        <i class="fas fa-layer-group"></i> 
                    </span>
                    <span style="background: var(--primary-gradient-vibrant); color: #fff; padding: 4px 12px; border-radius: 20px; font-size: 0.8em; font-weight: 700;">
                        ${count} 
                    </span>
                </div>
                ${schemes.map((scheme, index) => `
                    <div class="scheme-item" onclick="loadScheme(${scheme.id})" style="animation: fadeInUp 0.3s ease-out; animation-delay: ${index * 0.05}s; animation-fill-mode: both;">
                        <div class="scheme-item-icon">
                            <i class="fas fa-microchip"></i>
                        </div>
                        <div class="scheme-item-info">
                            <div class="scheme-item-name">${scheme.name}</div>
                            <div class="scheme-item-desc">
                                ${scheme.config.modelPath ? scheme.config.modelPath.split('/').pop().split('\\').pop() : ''}  
                                ${scheme.config.condaEnv || 'vllm'}  
                                ${(scheme.envType || scheme.config.envType || 'wsl') === 'wsl' ? 'WSL' : 'Linux'}
                            </div>
                        </div>
                        <div class="scheme-item-actions">
                            <button class="scheme-action-btn" onclick="event.stopPropagation(); previewScheme(${scheme.id})" title="">
                                <i class="fas fa-eye"></i>
                                <span></span>
                            </button>
                            <button class="scheme-action-btn" onclick="event.stopPropagation(); editScheme(${scheme.id})" title="">
                                <i class="fas fa-pen"></i>
                                <span></span>
                            </button>
                            <button class="scheme-action-btn delete" onclick="event.stopPropagation(); deleteScheme(${scheme.id})" title="">
                                <i class="fas fa-trash"></i>
                                <span></span>
                            </button>
                        </div>
                    </div>
                `).join('')}
            ` : '<div style="padding: 30px 20px; text-align: center; color: #64748b;"><i class="fas fa-folder-open" style="font-size: 2em; margin-bottom: 10px; opacity: 0.5;"></i><br><br><span style="font-size: 0.85em; opacity: 0.7;">""</span></div>';
        };

        const loadScheme = (id) => {
            const scheme = schemes.find(s => s.id === id);
            if (scheme) {
                loadConfig(scheme.config);
                currentScheme = scheme;
                document.getElementById('schemeSelectText').innerHTML = `<i class="fas fa-check-circle"></i> ${scheme.name}`;
                document.getElementById('schemeListPopup').classList.remove('show');
                showToast(` "${scheme.name}"`, 'success');
                log(`: ${scheme.name}`, 'info');
            }
        };

        const previewScheme = async (id) => {
            const scheme = schemes.find(s => s.id === id);
            if (scheme) {
                // Temporarily set currentEnv to scheme's envType
                const originalEnv = currentEnv;
                currentEnv = scheme.envType || scheme.config.envType || 'wsl';
                
                // Generate command preview
                const command = await generateCommand(scheme.config);
                
                // Restore original env
                currentEnv = originalEnv;
                
                // Show in command preview modal with null checks
                const previewNameEl = document.getElementById('previewSchemeName');
                const previewContentEl = document.getElementById('previewCommandContent');
                const previewModalEl = document.getElementById('commandPreviewModal');
                
                if (previewNameEl) {
                    previewNameEl.innerHTML = `<i class="fas fa-eye"></i> : ${scheme.name}`;
                }
                if (previewContentEl) {
                    previewContentEl.innerHTML = command;
                }
                if (previewModalEl) {
                    previewModalEl.style.display = 'flex';
                }
            }
        };

        const editScheme = async (id) => {
            const scheme = schemes.find(s => s.id === id);
            if (scheme) {
                const newName = prompt(':', scheme.name);
                if (newName && newName.trim()) {
                    const oldName = scheme.name;
                    scheme.name = newName.trim();
                    
                    try {
                        const response = await fetch('/api/schemes', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                scheme: {
                                    name: scheme.name,
                                    config: scheme.config,
                                    envType: scheme.envType
                                }
                            })
                        });
                        
                        const result = await response.json();
                        
                        if (result.success) {
                            updateSchemeList();
                            if (currentScheme && currentScheme.id === id) {
                                document.getElementById('schemeSelectText').innerHTML = `<i class="fas fa-check-circle"></i> ${scheme.name}`;
                            }
                            showToast(` "${oldName}"  "${scheme.name}"`, 'success');
                            log(` "${oldName}"  "${scheme.name}"`, 'success');
                        } else {
                            // Revert name on failure
                            scheme.name = oldName;
                            showToast(result.message || '', 'error');
                        }
                    } catch (e) {
                        // Revert name on error
                        scheme.name = oldName;
                        showToast(': ' + e.message, 'error');
                    }
                }
            }
        };

        const deleteScheme = async (id) => {
            const scheme = schemes.find(s => s.id === id);
            if (scheme && confirm(` "${scheme.name}" ?`)) {
                try {
                    const response = await fetch(`/api/schemes/${id}`, { method: 'DELETE' });
                    const result = await response.json();
                    
                    if (result.success) {
                        schemes = schemes.filter(s => s.id !== id);
                        updateSchemeList();
                        if (currentScheme && currentScheme.id === id) {
                            document.getElementById('schemeSelectText').innerHTML = `...`;
                            currentScheme = null;
                        }
                        showToast(` "${scheme.name}" `, 'info');
                        log(` "${scheme.name}" `, 'warning');
                    } else {
                        showToast(result.message || '', 'error');
                    }
                } catch (e) {
                    showToast(': ' + e.message, 'error');
                }
            }
        };

        const toggleSchemeList = () => {
            const popup = document.getElementById('schemeListPopup');
            const button = document.getElementById('currentScheme');
            
            if (popup.classList.contains('show')) {
                popup.classList.remove('show');
            } else {
                // Calculate position relative to the button
                const buttonRect = button.getBoundingClientRect();
                popup.style.top = `${buttonRect.bottom + 8}px`;
                popup.style.left = `${buttonRect.left}px`;
                popup.classList.add('show');
            }
        };

        document.addEventListener('click', (e) => {
            const popup = document.getElementById('schemeListPopup');
            const button = document.getElementById('currentScheme');
            if (!e.target.closest('#schemeListPopup') && !e.target.closest('#currentScheme')) {
                popup.classList.remove('show');
            }
        });

        window.addEventListener('beforeunload', () => {
            if (isRunning) {
                fetch('/api/stop', { method: 'POST' });
            }
        });

        let gpuPollInterval = null;
        let nvitopActive = false;

        const fetchGPUStatus = async () => {
            try {
                const response = await fetch('/api/gpu-status');
                const result = await response.json();
                const gpuGrid = document.getElementById('gpuGrid');
                
                if (result.status === 'ok' && result.gpus && result.gpus.length > 0) {
                    gpuGrid.innerHTML = result.gpus.map((gpu, index) => {
                        // Calculate memory percentage for progress bar
                        const memUsed = gpu.memory_used || 0;
                        const memTotal = gpu.memory_total || 1;
                        const memPercent = Math.round((memUsed / memTotal) * 100);
                        const utilPercent = gpu.utilization || 0;
                        
                        return `
                        <div class="gpu-item">
                            <div class="gpu-name">
                                <i class="fas fa-video"></i>
                                <span>${gpu.name || `GPU ${index}`}</span>
                            </div>
                            <div class="gpu-progress-container">
                                <div class="gpu-progress-item">
                                    <div class="gpu-progress-bar">
                                        <div class="gpu-progress-fill memory" style="width: ${memPercent}%"></div>
                                    </div>
                                    <span class="gpu-progress-label">${gpu.memory_used} / ${gpu.memory_total} MB</span>
                                </div>
                                <div class="gpu-progress-item">
                                    <div class="gpu-progress-bar">
                                        <div class="gpu-progress-fill util" style="width: ${utilPercent}%"></div>
                                    </div>
                                    <span class="gpu-progress-label">: ${gpu.utilization}%</span>
                                </div>
                            </div>
                            <div class="gpu-temp">
                                <span class="gpu-label"></span>
                                ${gpu.temperature}C
                            </div>
                            <div class="gpu-power">
                                <span class="gpu-label"></span>
                                ${gpu.power}W
                            </div>
                            <div class="gpu-fan">
                                <span class="gpu-label"></span>
                                ${gpu.fan_speed || 0}%
                            </div>
                        </div>
                        `;
                    }).join('');
                    document.getElementById('gpuStatusBox').classList.add('running');
                } else {
                    gpuGrid.innerHTML = '<div class="gpu-empty">GPU</div>';
                    document.getElementById('gpuStatusBox').classList.remove('running');
                }
            } catch (error) {
                console.error('GPU:', error);
                document.getElementById('gpuGrid').innerHTML = '<div class="gpu-empty">GPU</div>';
            }
        };

        const startGPUPolling = () => {
            fetchGPUStatus();
            gpuPollInterval = setInterval(fetchGPUStatus, 2000);
        };

        const stopGPUPolling = () => {
            if (gpuPollInterval) {
                clearInterval(gpuPollInterval);
                gpuPollInterval = null;
            }
        };

        // nvitop
        const startNvitopMonitoring = async () => {
            try {
                const response = await fetch('/api/nvitop', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'start',
                        envType: currentEnv
                    })
                });
                const result = await response.json();
                if (result.status === 'started') {
                    nvitopActive = true;
                    log('nvitop', 'success');
                }
            } catch (error) {
                log(`nvitop: ${error.message}`, 'error');
            }
        };

        const stopNvitopMonitoring = async () => {
            try {
                const response = await fetch('/api/nvitop', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'stop' })
                });
                const result = await response.json();
                if (result.success) {
                    nvitopActive = false;
                    log('nvitop', 'success');
                }
            } catch (error) {
                log(`nvitop: ${error.message}`, 'error');
            }
        };

        const initSocket = () => {
            try {
                socket = io({
                    transports: ['polling', 'websocket'],
                    reconnection: true,
                    reconnectionAttempts: 10,
                    reconnectionDelay: 1000,
                    reconnectionDelayMax: 5000,
                    timeout: 20000
                });
                
                socket.on('connect', () => {
                    log('', 'system');
                });

                socket.on('connect_error', (error) => {
                    log(`: ${error.message}`, 'error');
                });

                socket.on('disconnect', () => {
                    log('', 'error');
                });

                socket.on('log', (data) => {
                    log(data.message, data.level || 'output');
                });

                socket.on('status', (data) => {
                    if (data.running) {
                        isRunning = true;
                        const port = document.getElementById('port').value || 8000;
                        document.getElementById('runningStatus').innerHTML = `
                            <div class="running-status">
                                <span class="status-label"></span>
                                <span class="port-badge">: ${port}</span>
                            </div>
                        `;
                        document.getElementById('runningStatus').className = 'status-content ready';
                        document.getElementById('statusText').textContent = '';
                        document.getElementById('statusDot').classList.add('running');
                        document.querySelectorAll('.action-buttons button').forEach(btn => {
                            if (btn.classList.contains('btn-run')) btn.disabled = true;
                        });
                        // nvitopGPU
                        stopNvitopMonitoring();
                        startGPUPolling();
                    } else {
                        isRunning = false;
                        document.getElementById('runningStatus').innerHTML = '<span style="color: #22c55e;"></span>';
                        document.getElementById('runningStatus').className = 'status-content';
                        document.getElementById('statusText').textContent = '';
                        document.getElementById('statusDot').classList.remove('running');
                        document.querySelectorAll('.action-buttons button').forEach(btn => { btn.disabled = false; });
                        // GPUnvitop
                        stopGPUPolling();
                        startNvitopMonitoring();
                    }
                });

                // nvitop
                socket.on('nvitop', (data) => {
                    if (data.output) {
                        // nvitopGPUnvitop
                        if (nvitopActive) {
                            const gpuGrid = document.getElementById('gpuGrid');
                            // nvitop
                            gpuGrid.innerHTML = `<div class="gpu-item" style="grid-template-columns: 1fr; font-family: monospace; font-size: 0.8em;">${data.output}</div>`;
                        }
                    }
                });
            } catch (error) {
                log(`WebSocket: ${error.message}`, 'error');
            }
        };

        // 
        const exitApplication = async () => {
            if (!confirm('')) {
                return;
            }
            
            log('...', 'warning');
            
            try {
                // vLLM
                if (isRunning) {
                    await fetch('/api/stop', { method: 'POST' });
                    log('vLLM', 'success');
                }
                
                // nvitop
                await stopNvitopMonitoring();
                
                // GPU
                stopGPUPolling();
                
                // WebSocket
                if (socket) {
                    socket.disconnect();
                    socket = null;
                }
                
                // Python- #12
                try {
                    await fetch('/api/stop', { method: 'POST' });
                    log('', 'success');
                } catch (e) {
                    // 
                }
                
                // UI
                isRunning = false;
                document.getElementById('runningStatus').innerHTML = '<span style="color: #94a3b8;"></span>';
        document.getElementById('runningStatus').className = 'status-content';
                document.getElementById('runningStatus').className = 'status-content error';
                document.getElementById('statusText').textContent = '';
                document.getElementById('statusDot').classList.remove('running');
                document.getElementById('statusDot').classList.add('error');
                
                // 
                document.querySelectorAll('.action-buttons button').forEach(btn => {
                    btn.disabled = true;
                });
                // 
                document.querySelector('.btn-exit').disabled = false;
                
                log('...', 'success');
                
                // 
                try {
                    await fetch('/api/shutdown', { method: 'POST' });
                } catch (e) {
                    // 
                }
                
                // 
                setTimeout(async () => {
                    // 
                    try {
                        const response = await fetch('/api/shutdown', { method: 'POST' });
                        const result = await response.json();
                        if (result.success) {
                            log('', 'success');
                        }
                    } catch (e) {
                        // 
                    }
                    
                    // 
                    try {
                        if (window.opener) {
                            window.close();
                        } else {
                            //  window.close()
                            window.open('', '_self', '');
                            window.close();
                        }
                    } catch (e) {
                        log('', 'warning');
                    }
                }, 500);
                
            } catch (error) {
                log(`: ${error.message}`, 'error');
            }
        };

        // ====================  ====================
        const validationRules = {
            // 
            modelPath: {
                validate: (value) => {
                    if (!value || value.trim() === '') return { valid: false, message: '' };
                    if (value.includes('..')) return { valid: false, message: '..' };
                    return { valid: true, message: '' };
                },
                trigger: 'input'
            },
            // 1-65535
            port: {
                validate: (value) => {
                    if (!value) return { valid: true, message: '8000' };
                    if (!/^\d+$/.test(value)) return { valid: false, message: '' };
                    const portNum = parseInt(value);
                    if (portNum < 1 || portNum > 65535) return { valid: false, message: '1-65535' };
                    return { valid: true, message: '' };
                },
                trigger: 'input'
            },
            // 1-8
            tensorParallel: {
                validate: (value) => {
                    if (!value) return { valid: true, message: '1' };
                    if (!/^\d+$/.test(value)) return { valid: false, message: '' };
                    const num = parseInt(value);
                    if (num < 1 || num > 8) return { valid: false, message: '1-8' };
                    return { valid: true, message: '' };
                },
                trigger: 'input'
            },
            // GPU0.1-1.0
            gpuMemoryUtil: {
                validate: (value) => {
                    if (!value) return { valid: true, message: '0.9' };
                    const num = parseFloat(value);
                    if (isNaN(num)) return { valid: false, message: '' };
                    if (num < 0.1 || num > 1.0) return { valid: false, message: '0.1-1.0' };
                    return { valid: true, message: '' };
                },
                trigger: 'input'
            },
            // CUDA
            cudaDevices: {
                validate: (value) => {
                    if (!value) return { valid: true, message: '0' };
                    if (!/^[0-9,]+$/.test(value)) return { valid: false, message: '' };
                    return { valid: true, message: '' };
                },
                trigger: 'input'
            },
            // Conda
            condaEnv: {
                validate: (value) => {
                    if (!value) return { valid: true, message: 'vllm' };
                    if (!/^[a-zA-Z0-9_.-]+$/.test(value)) return { valid: false, message: '' };
                    return { valid: true, message: '' };
                },
                trigger: 'input'
            },
            // 
            maxModelLen: {
                validate: (value) => {
                    if (!value) return { valid: true, message: '' };
                    if (!/^\d+$/.test(value)) return { valid: false, message: '' };
                    const num = parseInt(value);
                    if (num < 1) return { valid: false, message: '0' };
                    return { valid: true, message: '' };
                },
                trigger: 'input'
            },
            maxNumSeqs: {
                validate: (value) => {
                    if (!value) return { valid: true, message: '256' };
                    if (!/^\d+$/.test(value)) return { valid: false, message: '' };
                    const num = parseInt(value);
                    if (num < 1) return { valid: false, message: '0' };
                    return { valid: true, message: '' };
                },
                trigger: 'input'
            },
            maxNumBatchedTokens: {
                validate: (value) => {
                    if (!value) return { valid: true, message: '8192' };
                    if (!/^\d+$/.test(value)) return { valid: false, message: '' };
                    const num = parseInt(value);
                    if (num < 1) return { valid: false, message: '0' };
                    return { valid: true, message: '' };
                },
                trigger: 'input'
            }
        };

        // 
        const initValidationSystem = () => {
            // 
            document.querySelectorAll('.param-input').forEach(input => {
                const fieldId = input.id;
                if (!fieldId) return;
                
                // 
                const statusIndicator = document.createElement('span');
                statusIndicator.className = 'validation-status';
                statusIndicator.id = `${fieldId}-validation`;
                statusIndicator.title = '';
                
                // input
                input.parentNode.appendChild(statusIndicator);
                
                // 
                const rule = validationRules[fieldId];
                if (rule) {
                    const validateField = () => {
                        const value = input.value.trim();
                        const result = rule.validate(value);
                        
                        // 
                        statusIndicator.className = 'validation-status';
                        if (result.valid) {
                            statusIndicator.classList.add('valid');
                            statusIndicator.innerHTML = '<i class="fas fa-check"></i>';
                            statusIndicator.title = result.message;
                        } else {
                            statusIndicator.classList.add('invalid');
                            statusIndicator.innerHTML = '<i class="fas fa-exclamation"></i>';
                            statusIndicator.title = result.message;
                        }
                    };
                    
                    // 
                    if (rule.trigger === 'input') {
                        input.addEventListener('input', validateField);
                        input.addEventListener('blur', validateField);
                    } else if (rule.trigger === 'change') {
                        input.addEventListener('change', validateField);
                    }
                    
                    // 
                    validateField();
                }
            });
            
            // 
            document.querySelectorAll('.param-checkbox input').forEach(checkbox => {
                const fieldId = checkbox.id;
                if (!fieldId) return;
                
                const statusIndicator = document.createElement('span');
                statusIndicator.className = 'validation-status valid';
                statusIndicator.id = `${fieldId}-validation`;
                statusIndicator.innerHTML = '<i class="fas fa-check"></i>';
                statusIndicator.title = ' - ';
                statusIndicator.style.top = '8px'; // 
                
                checkbox.parentNode.appendChild(statusIndicator);
            });
        };

        // ====================  ====================

        document.addEventListener('DOMContentLoaded', () => {
            // Global error handler to suppress third-party errors (e.g., Firebase, browser extensions)
            window.onerror = function(msg, url, line, col, error) {
                // Suppress Firebase Remote Config errors
                if (msg && msg.includes && (
                    msg.includes('FirebaseError') ||
                    msg.includes('Remote Config') ||
                    msg.includes('fetch-timeout')
                )) {
                    return true; // Suppress error
                }
                return false; // Let other errors through
            };

            updateSchemeList();
            initSocket();
            // nvitop
            setTimeout(() => startNvitopMonitoring(), 1000);
            initValidationSystem();
            
            // Auto-generate sh startup script in project folder
            setTimeout(async () => {
                const config = getConfig();
                if (config.modelPath) {
                    const scriptContent = generateShScript(config, '');
                    try {
                        const response = await fetch('/api/save-script', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                filename: `start_vllm.sh`,
                                content: scriptContent
                            })
                        });
                        const result = await response.json();
                        if (result.success) {
                            log(`: ${result.path}`, 'success');
                        }
                    } catch (e) {
                        // Silently fail, not critical
                    }
                }
            }, 1000);
            
            document.querySelectorAll('.panel-tab')[0].click();
            
            const inputs = document.querySelectorAll('.param-input, .param-checkbox input');
            inputs.forEach(input => {
                input.addEventListener('change', () => {
                    if (document.getElementById('commandPreview').textContent.includes('[vLLM ]')) {
                        generateCommand();
                    }
                });
            });
        });
    </script>
    <div class="scheme-list-popup" id="schemeListPopup"></div>
</body>
</html>
